<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd"><html lang="en"><meta content="text/html; charset=utf-8" http-equiv="content-type">
<title>Web Messaging API Specification</title>
<style type="text/css">
           pre.idl { border:solid thin; background:#eee; color:#000; padding:0.5em }
           pre.idl :link, pre.idl :visited { color:inherit; background:transparent }
           pre code { color:inherit; background:transparent }
           div.example { margin-left:1em; padding-left:1em; border-left:double;
                         color:#222; background:#fcfcfc }
           .note { margin-left:2em; font-weight:bold; font-style:italic; color:#008000 }
           p.note::before { content:"Note: " }
           .XXX { padding:.5em; border:solid #f00 }
           p.XXX::before { content:"Issue: " }
           dl.switch { padding-left:2em }
           dl.switch > dt { text-indent:-1.5em }
           dl.switch > dt:before { content:'\21AA'; padding:0 0.5em 0 0;
             display:inline-block; width:1em; text-align:right; line-height:0.5em }
           dl.domintro { color: green; margin: 2em 0 2em 2em; padding: 0.5em 1em;
             border: none; background: #DDFFDD; }
           dl.domintro dt, dl.domintro dt * { color: black; text-decoration: none; }
           dl.domintro dd { margin: 0.5em 0 1em 2em; padding: 0; }
           dl.domintro dd p { margin: 0.5em 0; }
           dl.domintro:before { display: table; margin: -1em -0.5em -0.5em auto; width: auto;
           content: 'This box is non-normative. Implementation requirements are given below this box.';
           color: red; border: solid 2px; background: white; padding: 0 0.25em; }
           em.ct { text-transform:lowercase; font-variant:small-caps; font-style:normal }
           dfn { font-weight:bold; font-style:normal }
           code { color:orangered }
           code :link, code :visited { color:inherit }
           hr:not(.top) { display:block; background:none; border:none; padding:0;
                          margin:2em 0; height:auto }
           table { border-collapse:collapse; border-style:hidden hidden none hidden }
           table thead { border-bottom:solid }
           table tbody th:first-child { border-left:solid }
           table td, table th { border-left:solid; border-right:solid;
                  border-bottom:solid thin; vertical-align:top; padding:0.2em }

</style>
<link href="http://www.w3.org/StyleSheets/TR/W3C-ED" rel="stylesheet">

<body class="draft">

<div class="head">
            <h1>Web Messaging API Specification</h1>
            <h2 class="no-num no-toc" id="editor-draft-31-december-2012">Editor Draft &mdash; 31 December 2012</h2>

            <dl>
                <dt>This version:
                <dd><!--begin-link--><a href="http://www.w3.org/2012/sysapps/">http://www.w3.org/2012/sysapps/</a><!--end-link-->

                <dt class="dontpublish">Participate:</dt>
                <dd class="dontpublish"><a href="mailto:public-sysapps@w3.org?subject=%5Bcontacts-api%5D%20">public-sysapps@w3.org</a> (<a href="http://lists.w3.org/Archives/Public/public-sysapps/">archives</a>)
                <dd class="dontpublish"><a href="https://www.w3.org/Bugs/Public/enter_bug.cgi?product=SysAppsWG&amp;component=Messaging%20API">File a bug</a>

                <dt>Latest version:
                <dd><!--begin-link--><a href="http://www.w3.org/2012/sysapps/">http://www.w3.org/2012/sysapps/</a><!--end-link-->

                <dt>Previous versions:
                <dd><!--begin-link--><a href="http://www.w3.org/2012/sysapps/">http://www.w3.org/2012/sysapps/</a><!--end-link-->

                <dt>Editors:
                <dd class="vcard">
                               <span class="fn">Zoltan Kis</span>,
                               <span class="org"><a href="http://www.intel.com/">Intel Corporation</a></span>,
                               <span class="email"><a href="mailto:zoltan.kis@intel.com">zoltan.kis@intel.com</a></span>
            </dl>

            <div class="w3conly">
<!--begin-copyright-->
<p class="copyright"><a href="http://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a> &copy; 2012 <a href="http://www.w3.org/"><abbr title="World Wide Web Consortium">W3C</abbr></a><sup>&reg;</sup> (<a href="http://www.csail.mit.edu/"><abbr title="Massachusetts Institute of Technology">MIT</abbr></a>, <a href="http://www.ercim.eu/"><abbr title="European Research Consortium for Informatics and Mathematics">ERCIM</abbr></a>, <a href="http://www.keio.ac.jp/">Keio</a>), All Rights Reserved. W3C <a href="http://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">liability</a>, <a href="http://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">trademark</a> and <a href="http://www.w3.org/Consortium/Legal/copyright-documents">document use</a> rules apply.</p>
<!--end-copyright--></div>
</div>

<div id="abstract">
   <h2 class="no-num no-toc" id="abstract-0">Abstract</h2>
   <p> This specification defines a System Level API which provides interface to
   manage messaging, such as SMS, MMS, USSD, email, instant messages,
   and group chat over multiple protocols, providers and user accounts.
   For instance, SMS can be delivered via GSM or SIP, and using multiple
   SIM cards or SIP accounts. Such scenarios are managed by using
   <a href="#messaging-service" title="messaging service">messaging services</a>. This API supports
   multiple messaging services, and defines default services for simplifying
   basic usage for applications which e.g. just want to send an SMS quickly.
   The various messaging types are all covered in this same specification
   because much of the functionality can be shared, for instance managing messaging
   services, common properties, conversations, folders, labels, and messages.</p>
   <p><p>A typical use case of the API is the implementation of standalone or unified
   messaging client applications.</p>
</div>

<h2 class="no-num no-toc" id="toc">Table of Contents</h2>

<!--begin-toc-->
<ol class="toc">
 <li><a href="#introduction-0"><span class="secno">1 </span>Introduction</a></li>
 <li><a href="#conformance-0"><span class="secno">2 </span>Conformance</a></li>
 <li><a href="#terminology-0"><span class="secno">3 </span>Terminology</a></li>
 <li><a href="#security-and-privacy-considerations"><span class="secno">4 </span>Security and privacy considerations</a></li>
 <li><a href="#web-messaging-api"><span class="secno">5 </span>Web Messaging API</a>
  <ol class="toc">
   <li><a U0003Ccode="" href="#navigator" interface="" title=""><span class="secno">5.1 </span>Navigator</a></li>
   <li><a href="#interface-messaging"><span class="secno">5.2 </span>Interface <code title="">Messaging</code></a></li>
   <li><a href="#interface-messagingupdateevent"><span class="secno">5.3 </span>Interface <code title="">MessagingUpdateEvent</code></a></li>
   <li><a href="#interface-messagingservicemanager"><span class="secno">5.4 </span> Interface <code title="">MessagingServiceManager</code></a></li>
   <li><a href="#interface-messagingservice"><span class="secno">5.5 </span>Interface <code title="">MessagingService</code></a></li>
   <li><a href="#interface-smsservice"><span class="secno">5.6 </span>Interface <code title="">SmsService</code></a></li>
   <li><a href="#interface-ussdservice"><span class="secno">5.7 </span>Interface <code title="">UssdService</code></a></li>
   <li><a href="#interface-mmsservice"><span class="secno">5.8 </span>Interface <code title="">MmsService</code></a></li>
   <li><a href="#interface-emailservice"><span class="secno">5.9 </span>Interface <code title="">EmailService</code></a></li>
   <li><a href="#interface-imservice"><span class="secno">5.10 </span>Interface <code title="">ImService</code></a></li>
   <li><a href="#interface-groupchatservice"><span class="secno">5.11 </span>Interface <code title="">GroupChatService</code></a></li>
   <li><a href="#interface-chatroom"><span class="secno">5.12 </span>Interface <code title="">ChatRoom</code></a></li>
   <li><a href="#interface-message"><span class="secno">5.13 </span>Interface <code title="">Message</code></a></li>
   <li><a href="#interface-smsmessage"><span class="secno">5.14 </span>Interface <code title="">SmsMessage</code></a></li>
   <li><a href="#interface-mmsmessage"><span class="secno">5.15 </span>Interface <code title="">MmsMessage</code></a></li>
   <li><a href="#interface-emailmessage"><span class="secno">5.16 </span>Interface <code title="">EmailMessage</code></a></li>
   <li><a href="#interface-emailbody"><span class="secno">5.17 </span>Interface <code title="">EmailBody</code></a></li>
   <li><a href="#interface-messageattachment"><span class="secno">5.18 </span>Interface <code title="">MessageAttachment</code></a></li>
   <li><a href="#interface-messagelabel"><span class="secno">5.19 </span>Interface <code title="">MessageLabel</code></a></li>
   <li><a href="#interface-messagefolder"><span class="secno">5.20 </span>Interface <code title="">MessageFolder</code></a></li>
   <li><a href="#interface-messageconversation"><span class="secno">5.21 </span>Interface <code title="">MessageConversation</code></a></ol></li>
 <li><a href="#data-models"><span class="secno">6 </span>Data Models</a>
  <ol class="toc">
   <li><a href="#interface-livesearch"><span class="secno">6.1 </span>Interface <code title="">LiveSearch</code></a></li>
   <li><a href="#interface-livemodel"><span class="secno">6.2 </span>Interface <code title="">LiveModel</code></a></ol></li>
 <li><a href="#asynchronous-operations"><span class="secno">7 </span>Asynchronous operations</a>
  <ol class="toc">
   <li><a href="#interface-pendingrequest"><span class="secno">7.1 </span>Interface <code title="">PendingRequest</code></a></li>
   <li><a href="#interface-sendrequest"><span class="secno">7.2 </span>Interface <code title="">SendRequest</code></a></ol></li>
 <li><a href="#data-filtering"><span class="secno">8 </span>Data filtering</a>
  <ol class="toc">
   <li><a href="#interface-abstractfilter"><span class="secno">8.1 </span>Interface <code title="">AbstractFilter</code></a></li>
   <li><a href="#interface-attributefilter"><span class="secno">8.2 </span>Interface <code title="">AttributeFilter</code></a></li>
   <li><a href="#interface-attributerangefilter"><span class="secno">8.3 </span>Interface <code title="">AttributeRangeFilter</code></a></li>
   <li><a href="#interface-compositefilter"><span class="secno">8.4 </span>Interface <code title="">CompositeFilter</code></a></li>
   <li><a href="#dictionary-filteroptions"><span class="secno">8.5 </span>Dictionary <code title="">FilterOptions</code></a></li>
   <li><a href="#interface-messagefilter"><span class="secno">8.6 </span>Interface <code title="">MessageFilter</code></a></ol></li>
 <li><a class="no-num" href="#references-0">References</a></li>
 <li><a class="no-num" href="#acknowledgments">Acknowledgements</a></ol>
<!--end-toc-->

<div id="introduction">
  <h2 id="introduction-0"><span class="secno">1 </span>Introduction</h2>
  <p>The messaging API provides an interface to the following functionality:<ul>
    <li>Retrieve available messaging services and monitor their changes (added,
    removed and changed services).</li>
    <li>Send messages through different messaging services.</li>
    <li>Set and use default services for SMS, MMS, USSD, email,
        instant messaging and group chat.</li>
    <li>Receive messages from all enabled messaging services.</li>
    </ul>
    A messaging service object represent interfaces for: <ul>
    <li>Send and receive messages.</li>
    <li>Access message storages: search, add, modify, and delete messages.</li>
    <li>Manage conversations, folders, and labels.</li>
    <li>In addition, certain services like email may provide interface to
    synchronize local and remote message storages.</li>
   </ul><p></p>
</div>

<div id="conformance">
   <h2 id="conformance-0"><span class="secno">2 </span>Conformance</h2>
   <p>This specification defines conformance criteria that apply to a
   single product: the <dfn id="ua">user agent</dfn> that implements the
   interfaces that it contains.
   </p>
   <p>Implementations that use ECMAScript to implement the APIs defined in
   this specification MUST implement them in a manner consistent with the
   ECMAScript Bindings defined in the Web IDL specification
   <a href="#refsWEBIDL">[WEBIDL]</a>, as this specification uses that
   specification and terminology.
   </p>
</div>

<div id="terminology">
   <h2 id="terminology-0"><span class="secno">3 </span>Terminology</h2>
   <p>The <code><a href="http://dev.w3.org/html5/spec/webappapis.html#eventhandler">
   EventHandler</a></code> interface represents a callback used for event
   handlers as defined in <a href="#refsHTML5">[HTML5]</a>.
   </p>
   <p>The concepts
   <dfn id="queue-a-task"><a href="http://dev.w3.org/html5/spec/webappapis.html#queue-a-task">queue a task</a></dfn>
   and <dfn id="fire-a-simple-event"><a href="http://dev.w3.org/html5/spec/webappapis.html#fire-a-simple-event">
   fire a simple event</a></dfn> are defined in <a href="#refsHTML5">[HTML5]</a>.
   </p>
   <p>The terms <dfn id="event-handler"><a href="http://dev.w3.org/html5/spec/webappapis.html#event-handlers">
   event handler</a></dfn> and
   <dfn id="event-handler-event-types"><a href="http://dev.w3.org/html5/spec/webappapis.html#event-handler-event-type">
   event handler event types</a></dfn> are defined in <a href="#refsHTML5">[HTML5]</a>.
   </p>
   <p>The term <dfn id="messaging-service" title="messaging service">messaging service</dfn> refers to
   an object exposing messaging functionality associated to a user account and
   a service provider. For example, SMS, MMS and USSD service is associated to
   one or multiple SIM cards (subscriber accounts) representing the user identity
   in the telephony service subscriptions.
   An email service is associated to a user email account on an email provider.
   An instant messaging service is associated with a user account in a given
   instant messaging or online group chat service.
   A default service is exposed for each messaging type under the
   <code>navigator.messaging</code> namespace.
   </p>
</div>

<div id="security">
      <h2 id="security-and-privacy-considerations"><span class="secno">4 </span>Security and privacy considerations</h2>
      <p>This API MUST be only exposed to trusted content.</p>
</div>

<div id="mainspec">
  <h2 id="web-messaging-api"><span class="secno">5 </span>Web Messaging API</h2>

  <!-- interface Navigator -->
  <div class="content">
    <h3 U0003Ccode="" id="navigator" interface="" title=""><span class="secno">5.1 </span>Navigator</h3>
    <p>The object which defines the entry point for messaging functionality.</p>
    <pre class="idl">    partial interface <dfn id="navigator-0">Navigator</dfn> {
        readonly attribute <a href="#messaging">Messaging</a> <a href="#navigator-messaging" title="Navigator-messaging">messaging</a>;
    };
    </pre>
    <p>The <dfn id="navigator-messaging" title="Navigator-messaging"><code>messaging</code></dfn> property
    represents the object which encapsulates and exposes messaging functionality.
    </p>
  </div> <!-- interface Navigator -->


  <div> <!-- interface Messaging -->
    <h3 id="interface-messaging"><span class="secno">5.2 </span>Interface <code title="">Messaging</code></h3>
    <p>Defines default services for accessing the functionality of the following
    messaging types: SMS, MMS, USSD, email, instant messaging and group chat.
    </p>
    <p>Messaging services of each supported messaging type can be discovered by
    creating and using a <a href="#messagingservicemanager"><code>MessagingServiceManager</code></a> object.
    This functionality is not exposed on the <code><a href="#messaging">Messaging</a></code> interface in
    this version of the specification.
    </p>
    <pre class="idl">    [NoInterfaceObject]
    interface <dfn id="messaging">Messaging</dfn> {
        attribute <a href="#smsservice">SmsService</a>       <a href="#messaging-sms" title="Messaging-sms">sms</a>;
        attribute <a href="#mmsservice">MmsService</a>       <a href="#messaging-mms" title="Messaging-mms">mms</a>;
        attribute <a href="#ussdservice">UssdService</a>      <a href="#messaging-ussd" title="Messaging-ussd">ussd</a>;
        attribute <a href="#emailservice">EmailService</a>     <a href="#messaging-email" title="Messaging-email">email</a>;
        attribute <a href="#imservice">ImService</a>        <a href="#messaging-im" title="Messaging-im">im</a>;
        attribute <a href="#groupchatservice">GroupChatService</a> <a href="#messaging-groupchat" title="Messaging-groupchat">groupchat</a>;
    };
    </pre>
    <p>The <dfn id="messaging-sms" title="Messaging-sms"><code>sms</code></dfn>
    property provides the default service for accessing SMS functionality.
    </p>
    <p>The <dfn id="messaging-mms" title="Messaging-mms"><code>mms</code></dfn>
    property provides the default service for accessing MMS functionality.
    </p>
    <p>The <dfn id="messaging-ussd" title="Messaging-ussd"><code>ussd</code></dfn>
    property provides the default service for accessing USSD functionality.
    </p>
    <p>The <dfn id="messaging-email" title="Messaging-email"><code>email</code></dfn>
    property provides the default service for accessing email functionality.
    </p>
    <p>The <dfn id="messaging-im" title="Messaging-im"><code>im</code></dfn>
    property provides the default service for accessing IM functionality.
    </p>
    <p>The <dfn id="messaging-groupchat" title="Messaging-groupchat"><code>groupchat</code></dfn>
    property provides the default service for accessing group chat functionality.
    </p>
    <p>The following example illustrates how to send SMS using the default SMS
    service.</p>
    <div class="example">
    <pre>    // invoke asynchronous send, and set the callbacks before exiting the block
    function sendSms(number, text){
        var handler = navigator.messaging.sms.send(number, text); // returns a PendingRequest
        handler.onsuccess = function() { window.console.log('message sent'); };
        handler.ondelivered = function() { window.console.log('message delivered'); };
        handler.onerror = function() { window.console.log('message sending failed'); };
    }
    sendSMS("+155512345", "A text message");
    </pre>
    </div>
  </div> <!-- interface Messaging -->


  <div> <!-- interface MessagingUpdateEvent-->
    <h3 id="interface-messagingupdateevent"><span class="secno">5.3 </span>Interface <code title="">MessagingUpdateEvent</code></h3>
    <p>Defines messaging update events, used for received messages, and
    for added, modified and changed objects in this API. Different objects
    implementing the <span>EventTarget</span> interface will specify what type
    of information the event SHOULD convey.</p>
    <pre class="idl">    [NoInterfaceObject]
    interface <dfn id="messagingupdateevent">MessagingUpdateEvent</dfn> : <span>Event</span> {
        readonly attribute any <a href="#messagingupdateevent-param" title="MessagingUpdateEvent-param">param</a>;
    };
    </pre>
    <p>The <dfn id="messagingupdateevent-param" title="MessagingUpdateEvent-param"><code>param</code></dfn>
    property can be <code>null</code>, a single value, an object, and an array
    of values or objects attached to the event. The value depends on the event
    target, and it is specified in the documentation of the specific event targets.
    </p>
  </div> <!-- interface MessagingUpdateEvent -->


  <div class=""> <!-- interface MessagingServiceManager -->
    <h3 id="interface-messagingservicemanager"><span class="secno">5.4 </span> Interface <code title="">MessagingServiceManager</code></h3>
    <p>Defines functionality to discover messaging services and monitor their
    changes. Implements the <a href="#livesearch"><code>LiveSearch</code></a> interface which
    provides filtered search of services and keeps the result set updated with
    later changes.
    <p> Implementing this interface is not normative.</p>
    <pre class="idl">    [NoInterfaceObject]
    interface <dfn id="messagingservicemanager">MessagingServiceManager</dfn> : <a href="#livesearch">LiveSearch</a> {
        readonly attribute DOMString? <a href="#messagingservicemanager-type" title="MessagingServiceManager-type">type</a>;
    };
    </pre>
    <p>The <dfn id="messagingservicemanager-type" title="MessagingServiceManager-type"><code>type</code></dfn>
    property provides the <a href="#messagingservice-type" title="MessagingService-type">type</a> of the
    messaging services handled from this object. The default value is
    <code>null</code> and means that messaging services are handled for all
    messaging types.
    </p>
    <p>The <a href="#livesearch-onadded" title="LiveSearch-onadded"><code>onadded</code></a>,
    <a href="#livesearch-onadded" title="LiveSearch-onadded"><code>onmodified</code></a>,
    <a href="#livesearch-onadded" title="LiveSearch-onadded"><code>onremoved</code></a> properties
    handle the <code>added</code>, <code>modified</code>, <code>removed</code>
    events, which MUST implement the <a href="#messagingupdateevent"><code>MessagingUpdateEvent</code></a>
    interface, in which the <span title="LiveSearch-param"><code>param</code><span>
    property MUST be a <span><code><a href="#messagingservice">MessagingService</a></code><span> object.
    </span></span></span></span></p>
    <p>The following example shows how to create a
    <a href="#messagingservicemanager"><code>MessagingServiceManager</code></a> object, how get all
    available SMS services using the <a href="#livesearch-find" title="LiveSearch-find">find()</a>
    method, how to handle changes in SMS services (new, removed and changed
    services), how to set the default SMS service and send a test message on all
    enabled SMS services.
    </p>
    <div class="example">
    <pre>    // create a service manager for handling SMS services
    var smsManager = new MessagingServiceManager("sms");

    // set up event handlers for changes
    smsManager.onadded = function(event) {
        smsServices.push(event.param); //'param' is an SmsService object
    };
    smsManager.onmodified = function(event) {
        // most likely changed capabilities, or service was enabled/disabled
        // update the user interface according to the change
        update_sms_service_ui(event.param); //'param' is an SmsService object
    };
    smsManager.onremoved = function(event) {
        // received the id of the removed service from 'event.param' as DOMString
        // instead of searching what to remove, simply trigger reloading the list
        reloadSmsServices = true;
        // it means that 'find()' will be called again at a suitable time
    };

   var smsServices = []; // will store here the list of SmsService objects
    boolean reloadSmsServices = false;

    // fetch the SMS services and run the tests on them
    var handler = smsManager.find(); // a PendingRequest object

    handler.onsuccess = function() {
        smsServices = result.services; // by default, flow control is not used
        if(smsServices == null || smsServices.length == 0)
            window.console.log('no available SMS services found');
        else
            runSmsTest(smsServices);
    };
    handler.onerror = function() {
        window.console.log("failed to get " + type + "services");
    };

    // function for sending SMS to the given number on the given service
    function sendSmsOnService(service, number, text) {
       var handler = service.send(number, text); // a PendingRequest object
       handler.onsuccess = function() {
           window.console.log("message to " + handler.args[1] +
               "sent on service " + handler.args[0].displayName);
       };
       handler.ondelivered = function() {
           window.console.log("message to " + handler.args[1] +
               "delivered on service " + handler.args[0].displayName);
           };
       handler.onerror = function() {
           window.console.log("message to " + handler.args[1] +
               "failed on service " + handler.args[0].displayName);
    };

    // function for sending a test SMS on each enabled service of the given list of SmsService objects
    function runSmsTest(smsServiceList) {
        if(smsServiceList != null &amp;&amp; smsServiceList.length &gt; 0) {
            // use the SMS services, e.g. show a list to the user
            // here just set the first service as default service for SMS
            navigator.messaging.sms = smsServices[0];
        }
        //send a test message on all enabled SMS services (SIM cards)
        for(i = 0; i &lt; smsServiceList.length; i++) {
            if(smsServices[i].enabled)
                sendSmsOnService(smsServices[i], "+155512345", "Hello");
        }
    };
    </pre>
    </div>
  </div> <!-- interface MessagingServiceManager -->


  <!-- interface MessagingService -->
  <div>
  <h3 id="interface-messagingservice"><span class="secno">5.5 </span>Interface <code title="">MessagingService</code></h3>
    <p>Defines properties for messaging service functionality which are common
    to all supported messaging types.
    If the <a href="#messagingservicemanager"><code>MessagingServiceManager</code></a> interface is
    supported, then for any change in this object a <code>modified</code> event
    MUST be fired on all service manager objects.
    </p>
    <pre class="idl">    [NoInterfaceObject]
    interface <dfn id="messagingservice">MessagingService</dfn> : <span>EventTarget</span> {
       readonly attribute DOMString <a href="#messagingservice-type" title="MessagingService-type">type</a>;
       readonly attribute DOMString? <a href="#messagingservice-id" title="MessagingService-id">id</a>;
       readonly attribute DOMString <a href="#messagingservice-displayname" title="MessagingService-displayName">displayName</a>;
       attribute boolean <a href="#messagingservice-enabled" title="MessagingService-enabled">enabled</a>;
       readonly attribute DOMString[]? <a href="#messagingservice-capabilities" title="MessagingService-capabilities">capabilities</a>;
       readonly attribute <a href="#livemodel">LiveModel</a>? <a href="#messagingservice-messages" title="MessagingService-messages">messages</a>;
       readonly attribute <a href="#livemodel">LiveModel</a>? <a href="#messagingservice-conversations" title="MessagingService-conversations">conversations</a>;
       readonly attribute <a href="#livemodel">LiveModel</a>? <a href="#messagingservice-folders" title="MessagingService-folders">folders</a>;
       readonly attribute <a href="#livemodel">LiveModel</a>? <a href="#messagingservice-labels" title="MessagingService-labels">labels</a>;
       <a href="#pendingrequest">PendingRequest</a> <a href="#messagingservice-removeall" title="MessagingService-removeAll">removeAll</a>();
       attribute <span>EventHandler</span> <a href="#messagingservice-onreceived" title="MessagingService-onreceived">onreceived</a>;
       attribute <span>EventHandler</span> <a href="#messagingservice-onenabled" title="MessagingService-onenabled">onenabled</a>;
       attribute <span>EventHandler</span> <a href="#messagingservice-ondisabled" title="MessagingService-ondisabled">ondisabled</a>;
       attribute <span>EventHandler</span> <a href="#messagingservice-oncapabilitieschanged" title="MessagingService-oncapabilitieschanged">oncapabilitieschanged</a>;
    };
    </pre>
    <p>The <dfn id="messagingservice-type" title="MessagingService-type"> <code>type</code> </dfn>
    property MUST return the message type supported by the messaging service.
    The value MUST be one of the following: <code>"sms"</code>, <code>"mms"</code>,
    <code>"ussd"</code>, <code>"email"</code>, <code>"im"</code>,
    <code>"groupchat"</code>. Filtering MUST be supported for this property.
    </p>
    <p>The <dfn id="messagingservice-id" title="MessagingService-id"> <code>id</code> </dfn> property
    MUST return the identifier of the service which provides messaging functionality.
    Note that the service identifier may also be used in services of other API,
    e.g. when other functionality is also provided, like calling, or file transfer.
    The value is associated to the service provider and the user account, e.g.:
    "mygmail1@gmail.com", "my.name@company.com", "sip-myid@sipprovider.com", etc.
    The value MUST be unique among messaging services.
    Filtering MUST be supported for this property.
    </p>
    <p>The <dfn id="messagingservice-displayname" title="MessagingService-displayName"> <code>displayName</code></dfn>
    property MUST return the name of the service as displayed in the application UI.
    Filtering MUST be supported for this property.
    </p>
    <p>The <dfn id="messagingservice-enabled" title="MessagingService-enabled"> <code>enabled</code> </dfn>
    property MUST return or set the availability of the service.
    The value <code>true</code> means the service is enabled, otherwise the
    service is disabled. The enabled status can be set by the application.
    Filtering MUST be supported for this property.
    </p>
    <p>The <dfn id="messagingservice-capabilities" title="MessagingService-capabilities"> <code>capabilities</code> </dfn>
    property MUST return the list of capabilities of the messaging service, or
    <code>null</code> if the feature is not supported.
    A capability represents a feature that a messaging service MAY support.
    The specific services define the valid values, e.g. email services may
    support folder synchronization, instant messaging services may support
    roster, file transfer, call, etc. Since many protocols support both messaging
    and calling, for instance if a messaging service supports calling (e.g. a SIP
    service), then the application could use the service <code>id</code> in the
    Telephony API as a telephony service identifier.
    The capability values used in the Messaging API MAY be from the following list:
    <ul>
    <li><code>"roster"</code>: support for contact list with presence information
    on instant messaging and group chat;</li>
    <li><code>"filetransfer"</code>: support for file transfer on instant messaging
    and group chat;</li>
    <li><code>"foldersync"</code>: support for email folder synchronization with
    a remote server;
    <li><code>"call"</code>: support for calls, i.e. the messaging service
    identifier can be used as a telephony service identifier;</li>
    <li>The service type MUST be listed as the first capability, and is related to
    the properties of the protocol(s) through which the service is delivered.
    The value for messaging service type MUST be one of the following:<ul>
    <li><code>"tel"</code>: used for cellular services such as SMS, MMS, USSD</li>
    <li><code>"sip"</code>: used for SIP messaging services such as SMS, IM,
    group chat</li>
    <li><code>"xmpp"</code>: used for XMPP messaging services such as IM,
    group chat</li>
    <li><code>"pop3"</code>: used for email services where the mailbox is
    accessed using POP3</li>
    <li><code>"imap"</code>: used for email services where the mailbox is
    accessed using IMAP</li>
    <li><code>"exchange"</code>: used for email services where the mailbox is
    accessed using Microsoft Exchange</li>
    <li><code>"http"</code>: used for web email services where the mailbox is
    accessed using HTTP.</li>
    </ul>
    Other messaging service types MAY be defined by the implementations.
    </li>
    </ul>
    Other messaging capabilities MAY be defined by the implementations.
    Filtering MUST be supported for this property.
    <p></p>
    <p>The <dfn id="messagingservice-messages" title="MessagingService-messages"> <code>messages</code> </dfn>
    property is a <a href="#livemodel"><code>LiveModel</code></a> object which accesses a
    storage of objects of type <span><code><a href="#message">Message</a></code><span>, and
    provides access to the message storage functionality: search, add drafts,
    modify and delete messages.
    The storage itself is defined and handled by the implementation.
    Sent messages MUST be added by the implementation to the database in use, so
    that a valid message identifier is generated.
    The <a href="#livesearch-onadded" title="LiveSearch-onadded"><code>onadded</code></a>,
    <a href="#livesearch-onadded" title="LiveSearch-onadded"><code>onmodified</code></a>,
    <a href="#livesearch-onadded" title="LiveSearch-onadded"><code>onremoved</code></a> properties
    handle the <code>added</code>, <code>modified</code>, <code>removed</code>
    events, which MUST implement the <a href="#messagingupdateevent"><code>MessagingUpdateEvent</code></a>
    interface, in which the
    <a href="#messagingupdateevent-param" title="MessagingUpdateEvent-param"><code>param</code></a> property
    MUST be an array of <span><code><a href="#message">Message</a></code><span> objects of the
    same type as the service.
    If the message storage access feature is not supported, the value MUST be
    set to <code>null</code>.
    </span></span></span></span></p>
    <p>The <dfn id="messagingservice-conversations" title="MessagingService-conversations"> <code>conversations</code> </dfn>
    property a <span><code>ItemStorage</code></span> object of type <span><code><a href="#messageconversation">
    MessageConversation</a></code><livemodel> which provides access to the conversations
    functionality: search, add, modify, and delete conversations.
    The <a href="#livesearch-onadded" title="LiveSearch-onadded"><code>onadded</code></a>,
    <a href="#livesearch-onadded" title="LiveSearch-onadded"><code>onmodified</code></a>,
    <a href="#livesearch-onadded" title="LiveSearch-onadded"><code>onremoved</code></a> properties
    handle the <code>added</code>, <code>modified</code>, <code>removed</code>
    events, which MUST implement the <a href="#messagingupdateevent"><code>MessagingUpdateEvent</code></a>
    interface, in which the
    <a href="#messagingupdateevent-param" title="MessagingUpdateEvent-param"><code>param</code></a> property
    MUST be a <span><code><a href="#messageconversation">MessageConversation</a></code><span> object.
    If the conversation management feature is not supported, the value MUST be
    set to <code>null</code>.
    </span></span></livemodel></span></p>
    <p>The <dfn id="messagingservice-folders" title="MessagingService-folders"> <code>folders</code> </dfn>
    property is a <span><code>ItemStorage</code></span> object of type <span><code><a href="#messagefolder">
    MessageFolder</a></code><span> which provides access to the messaging folders
    functionality: search, add, modify, and delete folders.
    The <a href="#livesearch-onadded" title="LiveSearch-onadded"><code>onadded</code></a>,
    <a href="#livesearch-onadded" title="LiveSearch-onadded"><code>onmodified</code></a>,
    <a href="#livesearch-onadded" title="LiveSearch-onadded"><code>onremoved</code></a> properties
    handle the <code>added</code>, <code>modified</code>, <code>removed</code>
    events, which MUST implement the <a href="#messagingupdateevent"><code>MessagingUpdateEvent</code></a>
    interface, in which the
    <a href="#messagingupdateevent-param" title="MessagingUpdateEvent-param"><code>param</code></a> property
    MUST be a <span><code><a href="#messagefolder">MessageFolder</a></code><span> object.
    If the folder management feature is not supported, the value MUST be set to
    <code>null</code>.
    </span></span></span></span></p>
    <p>The <dfn id="messagingservice-labels" title="MessagingService-labels"> <code>labels</code> </dfn>
    property a <span><code>ItemStorage</code></span> object of type <span><code><a href="#messagelabel">
    MessageLabel</a></code><span> which provides access to the messaging labels
    functionality: search, add, modify, and delete labels.
    The <a href="#livesearch-onadded" title="LiveSearch-onadded"><code>onadded</code></a>,
    <a href="#livesearch-onadded" title="LiveSearch-onadded"><code>onmodified</code></a>,
    <a href="#livesearch-onadded" title="LiveSearch-onadded"><code>onremoved</code></a> properties
    handle the <code>added</code>, <code>modified</code>, <code>removed</code>
    events, which MUST implement the <a href="#messagingupdateevent"><code>MessagingUpdateEvent</code></a>
    interface, in which the
    <a href="#messagingupdateevent-param" title="MessagingUpdateEvent-param"><code>param</code></a> property
    MUST be a <span><code><a href="#messagelabel">MessageLabel</a></code><span> object.
    If the label management feature is not supported, the value MUST be set to
    <code>null</code>.
    </span></span></span></span></p>
    <p>The <dfn id="messagingservice-removeall" title="MessagingService-removeAll"><code>removeAll</code></dfn>
    property provides a method for removing all messages, conversations, folders
    and labels from the messaging storage local to the device. It MUST NOT
    remove data from remote storages.
    This method is equivalent of invalidating the local message storage.
    The method returns a <a href="#pendingrequest"><code>PendingRequest</code></a> object for
    handling the completion of the asynchronous operation.
    </p>
    <p>The <dfn id="messagingservice-onreceived" title="MessagingService-onreceived"><code>onreceived</code></dfn>
    property MUST provide the event handler for the <code>received</code> event,
    fired when a message is received. The event MUST implement the
    <a href="#messagingupdateevent"><code>MessagingUpdateEvent</code></a> interface, in which the
    <a href="#messagingupdateevent-param" title="MessagingUpdateEvent-param"><code>param</code></a> property
    MUST be a <span><code><a href="#message">Message</a></code><span> object.
    </span></span></p>
    <p>The <dfn id="messagingservice-onenabled" title="MessagingService-onenabled"><code>onenabled</code></dfn>
    property is an event handler for the <code>enabled</code> simple event fired
    when the service is enabled.
    </p>
    <p>The <dfn id="messagingservice-ondisabled" title="MessagingService-ondisabled"><code>ondisabled</code></dfn>
    property is an event handler for the <code>disabled</code> event fired when
    the service is disabled.
    </p>
    <p>The <dfn id="messagingservice-oncapabilitieschanged" title="MessagingService-oncapabilitieschanged">
    <code>oncapabilitieschanged</code></dfn> property is an event handler for the
    <code>capabilitieschanged</code> event fired when the service capabilities
    have changed.
    </p>
  </div> <!-- interface MessagingService -->


  <div> <!-- interface SmsService -->
    <h3 id="interface-smsservice"><span class="secno">5.6 </span>Interface <code title="">SmsService</code></h3>
    <p>Defines SMS functionality using a service provided by the network operator,
    connected to a subscriber identity represented by a SIM card.
    There may be multiple SIM cards in a device, and each MUST have
    an <code><a href="#smsservice">SmsService</a></code> object associated. If the SIM card is in use, the
    service MUST appear as enabled.
    </p>
    <pre class="idl">    [NoInterfaceObject]
    interface <dfn id="smsservice">SmsService</dfn> : <a href="#messagingservice">MessagingService</a> {
        <a href="#sendrequest">SendRequest</a> <a href="#smsservice-send" title="SmsService-send">send</a>(DOMString <var title="">number</var>, DOMString <var title="">message</var>);
        <a href="#sendrequest">SendRequest[]</a> <a href="#smsservice-batchsend" title="SmsService-batchSend">batchSend</a>(DOMString[] <var title="">numbers</var>, DOMString <var title="">message</var>);
        unsigned short <a href="#smsservice-numberofsmssegments" title="SmsService-numberOfSmsSegments">numberOfSmsSegments</a>(DOMString <var title="">text</var>);
    };
    </pre>
    <p>The <dfn id="smsservice-send" title="SmsService-send"> <code>send</code> </dfn> property is a
    method for sending a text message to a phone number. The parameter
    <code><var>number</var></code> is the phone number of the destination.
    The parameter <code><a href="#message"><var>message</var></a></code> is the text message to be sent
    using the SMS service. It can span over multiple physical short messages.
    The method returns an <a href="#sendrequest"><code>SendRequest</code></a> object for
    handling the completion of the asynchronous operation. The implementation
    MUST fire a <code>success</code> event on this object when the message is
    sent, a <code>delivered</code> event when the service reports the
    message has been delivered, and an <code>error</code> event when an error
    occured.
    </p>
    <p>The <dfn id="smsservice-batchsend" title="SmsService-batchSend"> <code>batchSend</code> </dfn>
    property MUST provide a method for sending a text message to a list of phone
    numbers. The parameter <code><var>numbers</var></code> is the array
    containing the phone numbers of the destinations. The parameter
    <code><a href="#message"><var>message</var></a></code> is the text message to be sent using the
    SMS service. It can span over multiple physical short messages.
    The method returns an <a href="#sendrequest"><code>SendRequest</code></a> object for
    handling the completion of the asynchronous operation. The implementation
    MUST fire a <code>success</code> event on this object when the message is
    sent, a <code>delivered</code> event when the service reports the
    message has been delivered, and an <code>error</code> event when an error
    occured.
    </p>
    <p>The <dfn id="smsservice-numberofsmssegments" title="SmsService-numberOfSmsSegments">
           <code>numberOfSmsSegments</code> </dfn> method returns the number of
    SMS messages needed to send the message received in the
    <code><var>text</var></code> parameter by the SMS service.
    </p>
    <p>The following example shows how to get all SMS messages available on a
    given SMS service, and how to listen to changes in the results for new,
    removed and changed messages.
    </p>
    <div class="example">
    <pre class="highlight">    var messages = []; // a list to store all messages
    var smsService = navigator.messaging.sms; // or pick a service
    var updatefinished = false;
    var handler = smsService.messages.find(); // return a PendinRequest object
    handler.resultsLimit = 10; // get messages in batches of 10
    handler.onsuccess = function() {
          if(handler.result) {
              for(i = 0; i &lt; handler.result.length; i++)
                  messages.push(handler.result[i];
          }
          // update the messaging application's data model for SMS messages
          if(handler.state == "done") {
              // finish updating the data model
              updatefinished = true;
          }
    };
    handler.onerror = function() {
          window.console.log('getting SMS messages failed');
    }
    </pre>
    </div>
  </div> <!-- interface SmsService -->


  <div> <!-- interface UssdService -->
    <h3 id="interface-ussdservice"><span class="secno">5.7 </span>Interface <code title="">UssdService</code></h3>
    <p>Defines USSD functionality bound to a network operator service and a SIM
    card. There may be multiple SIM cards in a device, and each MUST have an
    <code><a href="#ussdservice">UssdService</a></code> object associated. If a SIM card is in use, the
    corresponding <code><a href="#ussdservice">UssdService</a></code> object MUST appear as enabled.
    USSD can be mobile-originated (pull) or network-originated (push).
    A connection is managed with the network, but there is no store-and-forward
    functionality, and there is no local storage associated with USSD. Replies
    made to a pull request are handled in the context of the same connection.
    </p>
    <pre class="idl">    [NoInterfaceObject]
    interface <dfn id="ussdservice">UssdService</dfn> : <a href="#messagingservice">MessagingService</a> {
        <a href="#pendingrequest">PendingRequest</a> <a href="#ussdservice-send" title="UssdService-send">send</a>(DOMString <var title="">command</var>);
     };
     </pre>
     <p>The <dfn id="ussdservice-send" title="UssdService-send">
            <code>send(<var title="">command</var>)</code> </dfn> method MUST send
     the provided USSD command to the network. The parameter
     <code><var>command</var></code> is the text command to be sent.
     The method MUST return a <a href="#sendrequest"><code>SendRequest</code></a> object for
     handling the completion of the asynchronous operation. The implementation
     MUST fire a <code>success</code> event on this object when the message is
     sent, and an <code>error</code> event when an error occured. When the
     service responds to the USSD request the implementation MUST fire a
     <code>delivered</code> event, with the
     <a href="#pendingrequest-result" title="PendingRequest-result"><code>result</code></a> property of
     the <a href="#pendingrequest"><code>PendingRequest</code></a> object set to the answer
     received from the service, represented as <code>DOMString</code>.
     Network-originated USSD messages are processed by the
     <a href="#messagingservice-onreceived" title="MessagingService-onreceived"><code>onreceived</code></a>
     event handler.
     </p>
  </div> <!-- interface UssdService -->


  <div> <!-- interface MmsService -->
    <h3 id="interface-mmsservice"><span class="secno">5.8 </span>Interface <code title="">MmsService</code></h3>
    <p>Provides access to MMS v1.2 functionality, bound to a service provided
    by the network operator, with subscriber identity represented by a SIM card.
    There may be multiple SIM cards in a device, and each MUST have an
    <a href="#mmsservice"><code>MmsService</code></a> object associated. If the SIM card is
    in use, the service MUST appear as enabled.
    The functionality covered by this interface includes message sending and
    automatic and manual message retrieval.
    </p>
    <pre class="idl">    [NoInterfaceObject]
    interface <dfn id="mmsservice">MmsService</dfn> : <a href="#messagingservice">MessagingService</a> {
        attribute boolean <a href="#mmsservice-manualfetch" title="MmsService-manualFetch">manualFetch</a>;
        <a href="#sendrequest">SendRequest</a> <a href="#mmsservice-send" title="MmsService-send">send</a>(<a href="#mmsmessage">MmsMessage</a> <var><a href="#mmsmessage">mmsMessage</a></var>);
    };
    </pre>
    <p>The <dfn id="mmsservice-manualfetch" title="MmsService-manualFetch"> <code>manualFetch</code> </dfn>
    property accesses and sets the flag controlling manual or automatic MMS
    retrieval. The value <code>true</code> corresponds to manual, and
    <code>false</code> to automatic MMS retrieval.
    The default value is <code>false</code>.
    </p>
    <p>The <dfn id="mmsservice-send" title="MmsService-send"> <code>send</code> </dfn> property
    provides a method for sending a multimedia message.
    The parameter <code><a href="#mmsmessage"><var>mmsMessage</var></a></code> is the message to be sent,
    completed with at least the list of phone numbers of the destinations, and
    a text message and/or a multimedia attachment.
    The method returns an <a href="#sendrequest"><code>SendRequest</code></a> object for
    handling the completion of the asynchronous operation. The implementation
    MUST fire a <code>success</code> event on this object when the message is
    sent, a <code>delivered</code> event when the service reports the
    message has been delivered, and an <code>error</code> event when an error
    occured and the sending process failed.
    </p>
  </div> <!-- interface MmsService -->


  <div> <!-- interface EmailService -->
    <h3 id="interface-emailservice"><span class="secno">5.9 </span>Interface <code title="">EmailService</code></h3>
    <p>Provides access to email functionality bound to a given email
    account. There may be multiple email accounts configured with the same
    provider; each MUST have a separate EmailService object associated. Then,
    the same email address may be configured through different protocols (e.g.
    IMAP vs Exchange); each should be represented by a separate
    <code><a href="#emailservice">EmailService</a></code> object.
    The email account information MUST be managed in a separate interface, which
    refers to the associated service identifier.
    </p>
    <pre class="idl">    [NoInterfaceObject]
    interface <dfn id="emailservice">EmailService</dfn> : <a href="#messagingservice">MessagingService</a> {
    <a href="#sendrequest">SendRequest</a> <a href="#emailservice-send" title="EmailService-send">send</a>(<a href="#emailmessage">EmailMessage</a> <var><a href="#emailmessage">emailMessage</a></var>);
        <a href="#pendingrequest">PendingRequest</a> <a href="#emailservice-loadbody" title="EmailService-loadBody">loadBody</a>(<a href="#message">Message</a> <var title="">message</var>);
        <a href="#pendingrequest">PendingRequest</a> <a href="#emailservice-syncfolder" title="EmailService-syncFolder">syncFolder</a>(DOMString <var title="">folderId</var>, boolean <var title="">recursive</var>, optional unsigned long <var title="">limit</var>);
        <a href="#pendingrequest">PendingRequest</a> <a href="#emailservice-sync" title="EmailService-sync">sync</a>(optional unsigned long <var title="">limit</var>);
    };
    </pre>
    <p>The <dfn id="emailservice-send" title="EmailService-send"> <code>send</code> </dfn> property
    provides a method for sending an email message.
    The parameter <code><a href="#emailmessage"><var>emailMessage</var></a></code> is the message to be sent,
    completed with at least the list of the destinations, and then at least
    either the subject, body or one attachment.
    The method returns an <a href="#sendrequest"><code>SendRequest</code></a> object for
    handling the completion of the asynchronous operation. The implementation
    MUST fire a <code>success</code> event on this object when the message is
    sent, a <code>delivered</code> event when the service reports the
    message has been delivered, and an <code>error</code> event when an error
    occured and the sending process failed.
    </p>
    <p>The <dfn id="emailservice-loadbody" title="EmailService-loadBody"><code>loadBody</code></dfn> method
    loads the body of the message, if not done yet when the message was retrieved
    from the service.
    The parameter <code><a href="#message"><var>message</var></a></code> is the object containing the
    incomplete email message.
    The method MUST return an <a href="#pendingrequest"><code>PendingRequest</code></a> object for
    handling the completion of the asynchronous operation. The implementation
    MUST fire a <code>success</code> event on this object when the message body
    is loaded, and an <code>error</code> event when an error occured. The
    <a href="#pendingrequest-result" title="PendingRequest-result"><code>result</code></a> property MUST
    contain an <a href="#emailbody"><code>EmailBody</code></a> object representing the full email body.
    </p>
    <p>The <dfn id="emailservice-syncfolder" title="EmailService-syncFolder"><code>syncFolder</code></dfn>
    method synchronizes folder content with an external mail server. This method
    MUST perform the following actions:<ul>
    <li>if both the
    <a href="#messagefolder-synchronizable" title="MessageFolder-synchronizable"><code>synchronizable</code></a>
    and the
    <a href="#messagefolder-exportlocalupdates" title="MessageFolder-exportLocalUpdates"><code>exportLocalUpdates</code></a>
    properties are <code>true</code> on the folder, then export local changes
    in the given folder to the server</li>
    <li>retrieve the list of available messages from within the given folder.</ul>
    Messages are retrieved from within a given folder, even if the
    <code>synchronizable</code> property for this folder is not set to <code>true</code>.
    The implementation decides which data is retrieved for every message: the message
    header details, or the whole message body. The parameter
    <code><var>folderId</var></code> is the folder identifier of the folder to
    be synchronized. The parameter <code><var>recursive</var></code> is a flag
    which if set to <code>true</code>, then the subfolders are also synchronized.
    The parameter <code><var>limit</var></code> is the limit set to the number
    of messages to be retrieved. If the limit is not set, the entire folder MUST
    be retrieved.
    The method returns an <a href="#pendingrequest"><code>PendingRequest</code></a> object for
    handling the completion of the asynchronous operation. The implementation
    MUST fire a <code>success</code> event on this object when the operation is
    finished, and an <code>error</code> event when an error occured.
    <p></p>
    <p>The <dfn id="emailservice-sync" title="EmailService-sync"> <code>sync</code> </dfn> method
    synchronizes the full email account with the external email server.
    The parameter <code><var>limit</var></code> represents the limit set to the
    total number of messages to be retrieved. If the limit is not set, all
    messages MUST be retrieved.
    The method returns an <a href="#pendingrequest"><code>PendingRequest</code></a> object for
    handling the completion of the asynchronous operation. The implementation
    MUST fire a <code>success</code> event on this object when the operation is
    finished, and an <code>error</code> event when an error occured.
    </p>
    <p>The following example illustrates how to search on emails on a given email
    service.</p>
    <div class="example">
    <pre>    // filter for "after 11.2.2010"
    var dateFilter = new AttributeRangeFilter("timestamp", new Date(2010, 1, 11));
    //filter for "from someone1@company1.com"
    var fromSomeone1 = new AttributeFilter("from", "is", "someone1@company1.com");
    //filter for "to someone2@company2.com"
    var toSomeone2 = new AttributeFilter("to", "contains", "someone2@company2.com");
    // filer for "has attachments"
    var hasAtt = new AttributeFilter("attachments", "exists");
    // our main filter
    var filter = new CompositeFilter("and", [dateFilter, fromSomeone1, toSomeone2, hasAtt]);

    var filterOptions = {sortBy: "timestamp", sortOrder: "descending"};
    var messages = []; // a list to store all messages
    var EmailService service = navigator.messaging.email; // or pick a service
    var updatefinished = false;

    // the implementation of 'find' will use EmailMessage properties
    var handler = service.messages.find(filter, filterOptions); // returns PendingRequest
    handler.resultsLimit = 10; // get messages in batches of 10
    handler.onsuccess = function() {
             if(handler.result) {
                 for(i = 0; i &lt; handler.result.length; i++)
                     messages.push(handler.result[i];
             }
             // update the messaging application's data model for email messages
             if(handler.state == "done") {
                 // finish updating the data model
                 updatefinished = true;
             }
    };
    handler.onerror = function() {
             window.console.log('getting SMS messages failed');
    }
    </pre>
    </div>
  </div>  <!-- interface EmailService -->


  <div> <!-- interface ImService -->
    <h3 id="interface-imservice"><span class="secno">5.10 </span>Interface <code title="">ImService</code></h3>
    <p>The interface for instant messaging functionality in a given service.
    </p>
    <pre class="idl">    [NoInterfaceObject]
    interface <dfn id="imservice">ImService</dfn> : <a href="#messagingservice">MessagingService</a> {
        attribute ContactManager <a href="#imservice-roster" title="ImService-roster">roster</a>;
        <a href="#pendingrequest">PendingRequest</a> <a href="#imservice-send" title="ImService-send">send</a>(DOMString <var title="">buddy</var>, DOMString <var title="">message</var>);
    };
    </pre>
    <p>The <dfn id="imservice-roster" title="ImService-roster"> <code>roster</code> </dfn> property
    provides an object with interface for managing chat contacts with presence.
    </p>
    <p>The <dfn id="imservice-send" title="ImService-send"> <code>send</code> </dfn> property is a
    method for sending a message to a buddy. The parameter
    <code><var>buddy</var></code> is the identifier of the buddy in the service.
    The value is received from the service (the
    <span><code>Contact-impp</code></span> property of the
    <span><code>Contact</code></span> object). The parameter
    <code><a href="#message"><var>message</var></a></code> is the text message sent to the chat room.
    The method returns an <a href="#pendingrequest"><code>PendingRequest</code></a> object for
    handling the completion of the asynchronous operation. The implementation
    MUST fire a <code>success</code> event on this object when the operation is
    finished, and an <code>error</code> event when an error occured.
    </p>
  </div> <!-- interface ImService -->


  <div> <!-- interface GroupChatService -->
    <h3 id="interface-groupchatservice"><span class="secno">5.11 </span>Interface <code title="">GroupChatService</code></h3>
    <p>Defines group chat functionality bound to a given service.</p>
    <pre class="idl">    [NoInterfaceObject]
    interface <dfn id="groupchatservice">GroupChatService</dfn> : <a href="#messagingservice">MessagingService</a> {
        readonly attribute <a href="#livesearch">LiveSearch</a> <a href="#groupchatservice-chatrooms" title="GroupChatService-chatRooms">chatRooms</a>;
    };
    </pre>
    <p>The <dfn id="groupchatservice-chatrooms" title="GroupChatService-chatRooms"> <code>chatRooms</code> </dfn>
    property provides a <a href="#livesearch"><code>LiveSearch</code></a> object handling
    searching and updates of objects of type <a href="#chatroom"><code>ChatRoom</code></a>,
    representing chat rooms provided by the group-chat service.
    </p>
  </div> <!-- interface GroupChatService -->


  <div> <!-- interface ChatRoom -->
    <h3 id="interface-chatroom"><span class="secno">5.12 </span>Interface <code title="">ChatRoom</code></h3>
    <p>Defines functionality for chat rooms. Implements the
    <a href="#messageconversation"><code>MessageConversation</code></a> interface for representing
    messages in the chat room, adds contact manager functionality for managing
    buddies with presence information, a generic command interface, and a method
    for posting messages in the chat room.
    <pre class="idl">    [NoInterfaceObject]
    interface <dfn id="chatroom">ChatRoom</dfn> : MessageConversation {
        readonly attribute <span>ContactManager</span> <a href="#chatroom-roster" title="ChatRoom-roster">roster</a>;
        <a href="#pendingrequest">PendingRequest</a> <a href="#chatroom-post" title="ChatRoom-post">post</a>(DOMString <var title="">message</var>);
        <a href="#pendingrequest">PendingRequest</a> <a href="#chatroom-command" title="ChatRoom-command">command</a>(DOMString <var title="">command</var>);
    };
    </pre>
    <p>The <dfn id="chatroom-roster" title="ChatRoom-roster"> <code>roster</code> </dfn>
    property provides an object with interface for managing chat contacts with
    presence information.
    </p>
    <p>The <dfn id="chatroom-post" title="ChatRoom-post"> <code>post</code> </dfn> method
    posts a message to the chat room. The parameter <code><a href="#message"><var>message</var>
    </a></code> is the text message sent to the chat room.
    The method returns an <a href="#pendingrequest"><code>PendingRequest</code></a> object for
    handling the completion of the asynchronous operation. The implementation
    MUST fire a <code>onsuccess</code> event on this object when the operation is
    finished, and an <code>onerror</code> event when an error occured.
    <p>The <dfn id="chatroom-command" title="ChatRoom-command"> <code>command</code> </dfn>
    method sends a command specific to the chat room.
    The parameter <code><var>command</var></code> is the text command accepted,
    interpreted and executed by the service in context of the chat room.
    The method returns an <a href="#pendingrequest"><code>PendingRequest</code></a> object for
    handling the completion of the asynchronous operation. The implementation
    MUST fire a <code>success</code> event on this object when the operation is
    finished, and an <code>error</code> event when an error occured.
    The <code>result</code> property may contain a protocol-dependent opaque
    object as a response, which has to be interpreted by the application.
    If there is no response, the value MUST be set to <code>null</code>.
    </p>
  </div> <!-- interface ChatRoom -->


  <div> <!-- interface Message -->
    <h3 id="interface-message"><span class="secno">5.13 </span>Interface <code title="">Message</code></h3>
    <p> Defines the common properties of all types of messages.
    </p>
    <pre class="idl">    interface <dfn id="message">Message</dfn> {
        readonly attribute DOMString? <a href="#message-id" title="Message-id">id</a>;
        readonly attribute DOMString? <a href="#message-serviceid" title="Message-serviceId">serviceId</a>;
        readonly attribute DOMString? <a href="#message-from" title="Message-from">from</a>;
        attribute DOMString <a href="#message-body" title="Message-body">body</a>;
        readonly attribute DOMString <a href="#message-status" title="Message-status">status</a>;
        readonly attribute Date <a href="#message-timestamp" title="Message-timestamp">timestamp</a>;
        attribute boolean <a href="#message-isread" title="Message-isRead">isRead</a>;
        readonly attribute DOMString? <a href="#message-conversationid" title="Message-conversationId">conversationId</a>;
        readonly attribute DOMString[]? <a href="#message-labels" title="Message-labels">labels</a>;
        readonly attribute DOMString? <a href="#message-folderid" title="Message-folderId">folderId</a>;
    };
    </pre>
    <p>The <dfn id="message-id" title="Message-id"> <code>id</code> </dfn> property MUST return
    the identifier of the message. It MUST be a unique and persistent property
    in the system, assigned by the implementation.
    By default, this attribute is set to <code>null</code>.
    For new messages created from the application, the property is set to
    <code>null</code>, and it is assigned on the first occasion that the message
    is processed by the system, for example when the message is sent, or saved
    to drafts.
    Filtering MUST be supported for this property.
    </p>
    <p>The <dfn id="message-serviceid" title="Message-serviceId"> <code>serviceId</code> </dfn> property
    MUST return the identifier of the service through which the message has been
    processed. By default, this attribute is set to <code>null</code>.
    Filtering MUST be supported for this property.
    </p>
    <p>The <dfn id="message-from" title="Message-from"> <code>from</code> </dfn> property MUST return
    the source address (or phone number) of a message. This property is
    set by the implementation, and by default it MUST be set to <code>null</code>.
    Filtering MUST be supported for this property.
    </p>
    <p>The <dfn id="message-body" title="Message-body"> <code>body</code> </dfn> property MUST
    return the body of the message.
    Filtering MAY be supported for this property.
    </p>
    <p>The <dfn id="message-status" title="Message-status"> <code>status</code> </dfn> property MUST
    return the status of the message. The value MUST be one of the following:<ul>
    <li><code>"received"</code>, for received messages</li>
    <li><code>"draft"</code>, for messages created and being edited, but not sent yet</li>
    <li><code>"sending"</code>, for messages being sent</li>
    <li><code>"sent"</code>, for messages which were successfully sent</li>
    <li><code>"failed"</code>, for messages for which the send operation failed</li>
    <li><code>"delivered"</code>, for messages known to be delivered by the service.
    Not every messaging service may support reporting this status.</ul>
    Filtering MUST be supported for this property.
    <p></p>
    <p>The <dfn id="message-timestamp" title="Message-timestamp"> <code>timestamp</code> </dfn> property
    MUST return the timestamp of the message. This property is set by the device
    or the web runtime environment.
    Filtering MUST be supported for this property.
    </p>
    <p>The <dfn id="message-isread" title="Message-isRead"> <code>isRead</code> </dfn> flag tells if
    the message has been marked as read. The application can set the flag.
    Filtering MUST be supported for this property.
    </p>
    <p>The <dfn id="message-conversationid" title="Message-conversationId"> <code>conversationId</code> </dfn>
    property MUST return the identifier of the conversation this message belongs
    to. By default, the value MUST be set to <code>null</code>.
    Filtering MUST be supported for this property.
    </p>
    <p>The <dfn id="message-labels" title="Message-labels"> <code>labels</code> </dfn> property MUST
    return the list of labels attached to the message, as array of strings.
    Filtering MUST be supported for this property.
    </p>
    <p>The <dfn id="message-folderid" title="Message-folderId"> <code>folderId</code> </dfn> property
    MUST return the folder identifier where the message belongs. By default, it
    MUST be set to <code>null</code>, meaning the message belongs to no folder.
    Values can be any user-settable strings. Implementations MUST support at
    least the <code>"inbox"</code> folder. Implementations MAY support the
    <code>"outbox"</code>, <code>"sent"</code>, <code>"drafts"</code>, and other
    folders. Filtering MUST be supported for this property.
    </p>
  </div> <!-- interface Message -->


  <div> <!-- interface SmsMessage -->
    <h3 id="interface-smsmessage"><span class="secno">5.14 </span>Interface <code title="">SmsMessage</code></h3>
    <p>Defines the properties of SMS messages.
    </p>
    <pre class="idl">    [Constructor(DOMString <var title="">to</var>, DOMString <var title="">message</var>)]
    interface <dfn id="smsmessage">SmsMessage</dfn> : <a href="#message">Message</a> {
        attribute DOMString <a href="#smsmessage-to" title="SmsMessage-to">to</a>;
    };
    </pre>
    <p>The <dfn id="smsmessage-to" title="SmsMessage-to"> <code>to</code> </dfn> property is the
    destination phone number of the message.
    Filtering MUST be supported for this property.
    </p>
  </div> <!-- interface SmsMessage -->


  <div> <!-- interface MmsMessage -->
    <h3 id="interface-mmsmessage"><span class="secno">5.15 </span>Interface <code title="">MmsMessage</code></h3>
    <p>Defines the properties of MMS messages.</p>
    <pre class="idl">    interface <dfn id="mmsmessage">MmsMessage</dfn> : <a href="#message">Message</a> {
        attribute DOMString[] <a href="#mmsmessage-to" title="MmsMessage-to">to</a>;
        attribute DOMString <a href="#mmsmessage-subject" title="MmsMessage-subject">subject</a>;
        attribute DOMString[] <a href="#mmsmessage-cc" title="MmsMessage-cc">cc</a>;
        attribute DOMString[] <a href="#mmsmessage-bcc" title="MmsMessage-bcc">bcc</a>;
        attribute <a href="#messageattachment">MessageAttachment[]</a>? <a href="#mmsmessage-attachments" title="MmsMessage-attachments">attachments</a>;
        attribute <span>Document</span>? <a href="#mmsmessage-smil" title="MmsMessage-smil">smil</a>;
    };
    </pre>
    <p>The <dfn id="mmsmessage-to" title="MmsMessage-to"> <code>to</code> </dfn> property is the
    array of destination addresses of the message.
    Filtering MUST be supported for this property, and matching SHOULD include
    the <code>cc</code> and <code>bcc</code> properties, too.
    </p>
    <p>The <dfn id="mmsmessage-subject" title="MmsMessage-subject"> <code>subject</code> </dfn> property
    is the subject of the message.
    Filtering MUST be supported for this property.
    </p>
    <p>The <dfn id="mmsmessage-cc" title="MmsMessage-cc"> <code>cc</code> </dfn> property is the
    array of carbon-copied destination addresses of the message.
    </p>
    <p>The <dfn id="mmsmessage-bcc" title="MmsMessage-bcc"> <code>bcc</code> </dfn> property is the
    array of blind carbon-copied destinations of the message.
    </p>
    <p>The <dfn id="mmsmessage-attachments" title="MmsMessage-attachments"> <code>attachments</code> </dfn>
    property is the array of attachments to the message. By default, the value
    MUST be set to <code>null</code>.
    Filtering on existence MUST be supported for this property.
    </p>
    <p>The <dfn id="mmsmessage-smil" title="MmsMessage-smil"> <code>smil</code> </dfn>
    property is the SMIL presentation settings attached to the message. If not
    available, it MUST be set to <code>null</code>, which is the default value.
    </p>
  </div> <!-- interface MmsMessage -->


  <div> <!-- interface EmailMessage -->
    <h3 id="interface-emailmessage"><span class="secno">5.16 </span>Interface <code title="">EmailMessage</code></h3>
    <p>Defines the structure of email messages.</p>
    <pre class="idl">    interface <dfn id="emailmessage">EmailMessage</dfn> : <a href="#mmsmessage">MmsMessage</a> {
        attribute DOMString <a href="#emailmessage-priority" title="EmailMessage-priority">priority</a>;
        attribute DOMString? <a href="#emailmessage-inresponseto" title="EmailMessage-inResponseTo">inResponseTo</a>;
        attribute <a href="#emailbody">EmailBody</a> <a href="#emailmessage-emailbody" title="EmailMessage-emailBody">emailBody</a>;
    };
    </pre>
    <p>The <dfn id="emailmessage-priority" title="EmailMessage-priority"> <code>priority</code> </dfn>
    property provides the priority of the email message. The following values MUST
    be supported: <code>"high"</code>, <code>"normal"</code> (the default value),
    <code>"low"</code>.
    Filtering MUST be supported for this property.
    </p>
    <p>The <dfn id="emailmessage-inresponseto" title="EmailMessage-inResponseTo"> <code>inResponseTo</code> </dfn>
    property provides the identifier of the original message that is being forwarded
    in this message, or to which this message is the reply.
    </p>
    <p>The <dfn id="emailmessage-emailbody" title="EmailMessage-emailBody"> <code>emailBody</code> </dfn>
    property provides the body of the email message.
    </p>
  </div> <!-- interface EmailMessage -->


  <div> <!-- interface EmailBody -->
    <h3 id="interface-emailbody"><span class="secno">5.17 </span>Interface <code title="">EmailBody</code></h3>
    <p>Defines the email body.</p>
    <pre class="idl">    [NoInterfaceObject]
    interface <dfn id="emailbody">EmailBody</dfn> {
        readonly attribute DOMString <a href="#emailbody-messageid" title="EmailBody-messageId">messageId</a>;
        readonly attribute boolean <a href="#emailbody-loaded" title="EmailBody-loaded">loaded</a>;
        attribute DOMString <a href="#emailbody-plainbody" title="EmailBody-plainBody">plainBody</a>;
        attribute DOMString? <a href="#emailbody-htmlbody" title="EmailBody-htmlBody">htmlBody</a>;
        attribute <a href="#messageattachment">MessageAttachment[]</a>? <a href="#emailbody-inlineattachments" title="EmailBody-inlineAttachments">inlineAttachments</a>;
    };
    </pre>
    <p>The <dfn id="emailbody-messageid" title="EmailBody-messageId"> <code>messageId</code> </dfn>
    property is the identifier of the message to which this email body belongs.
    </p>
    <p>The <dfn id="emailbody-loaded" title="EmailBody-loaded"> <code>loaded</code> </dfn> property
    describes whether the message body is loaded. The value is <code>true</code>
    if the message body is fully loaded, and <code>false</code> otherwise and by
    default.
    </p>
    <p>The <dfn id="emailbody-plainbody" title="EmailBody-plainBody"> <code>plainBody</code></dfn>
    property is the plain text representation of the message body.
    </p>
    <p>The <dfn id="emailbody-htmlbody" title="EmailBody-htmlBody"> <code>htmlBody</code> </dfn>
    property is the HTML representation of the message body. If the message does
    not have HTML body content, the value MUST be <code>null</code>.
    </p>
    <p>The <dfn id="emailbody-inlineattachments" title="EmailBody-inlineAttachments">
           <code>inlineAttachments</code> </dfn> property is the list of the
    inline attachments. This array is empty if the message does not have inline
    attachment or the message body is not loaded and attachments information is
    inaccessible (in this case the
    <a href="#emailbody-loaded" title="EmailBody-loaded"><code>loaded</code></a> property has
    to be checked). To indicate where to show an inline attachment within the HTML
    body, a link of the following format SHOULD be provided:
    <code>&lt;img src="The full path of a inline attachment"&gt;</code>.
    <div class="example">
    <pre>       var msg = new EmailMessage();
       msg.body.htmlBody = "...&lt; img src="images/myimage.png" &gt;...";
       msg.body.inlineAttachments = [new tMessageAttachment("images/myimage.png")];
    </pre>
    </div>
  </div> <!-- interface EmailBody -->


  <div> <!-- interface MessageAttachment -->
    <h3 id="interface-messageattachment"><span class="secno">5.18 </span>Interface <code title="">MessageAttachment</code></h3>
    <p> Defines message attachments. Depending on the messaging service type,
    different formats are accepted. The implementations MUST do the eventual
    conversions required by the service, for instance according to MMS conformance.
    </p>
    <pre class="idl">    [Constructor(DOMString <var title="">filePath</var>,
                 optional DOMString <var title="">mimeType</var>)]
    interface <dfn id="messageattachment">MessageAttachment</dfn> {
        readonly attribute DOMString? <a href="#messageattachment-id" title="MessageAttachment-id">id</a>;
        readonly attribute DOMString? <a href="#messageattachment-messageid" title="MessageAttachment-messageId">messageId</a>;
        readonly attribute DOMString? <a href="#messageattachment-mimetype" title="MessageAttachment-mimeType">mimeType</a>;
        readonly attribute DOMString? <a href="#messageattachment-uri" title="MessageAttachment-uri">uri</a>;
    };
    </pre>
    <p>The <dfn id="messageattachment-id" title="MessageAttachment-id"> <code>id</code> </dfn> property
    MUST provide the identifier of the message attachment.
    By default, this attribute MUST be set to <code>null</code>.
    </p>
    <p>The <dfn id="messageattachment-messageid" title="MessageAttachment-messageId"> <code>messageId</code> </dfn>
    property MUST provide the identifier of the parent message.
    By default, this attribute MUST be set to <code>null</code>.
    </p>
    <p>The <dfn id="messageattachment-mimetype" title="MessageAttachment-mimeType"> <code>mimeType</code> </dfn>
    property MUST provide the MIME type of the attachment, e.g. "text/html".
    By default, this attribute MUST be set to <code>null</code>.
    </p>
    <p>The <dfn id="messageattachment-uri" title="MessageAttachment-uri"> <code>uri</code> </dfn>
    property MUST provide the URI of the loaded attachment file. It holds the
    location path to the loaded attachment file. If the attachment is not loaded
    from the remote server, the value MUST be set to <code>null</code>.
    </p>
    <p>
  </div> <!-- interface MessageAttachment -->


  <div>  <!-- interface MessageLabel -->
    <h3 id="interface-messagelabel"><span class="secno">5.19 </span>Interface <code title="">MessageLabel</code></h3>
    <p>Defines message labels.
    </p>
    <pre class="idl">    [NoInterfaceObject]
    interface <dfn id="messagelabel">MessageLabel</dfn> {
        readonly attribute DOMString <a href="#messagelabel-id" title="MessageLabel-id">id</a>;
        attribute DOMString <a href="#messagelabel-name" title="MessageLabel-name">name</a>;
        readonly attribute DOMString <a href="#messagelabel-parentid" title="MessageLabel-parentId">parentId</a>;
        readonly attribute DOMString? <a href="#messagelabel-messagetype" title="MessageLabel-messageType">messageType</a>;
        readonly attribute DOMString? <a href="#messagelabel-serviceid" title="MessageLabel-serviceId">serviceId</a>;
    };
    </pre>
    <p>The <dfn id="messagelabel-id" title="MessageLabel-id"> <code>id</code> </dfn> property is the
    locally unique and persistent identifier of a message label.
    </p>
    <p>The <dfn id="messagelabel-name" title="MessageLabel-name"> <code>name</code> </dfn> property is
    the displayable name of the label.
    Filtering MUST be supported for this property.
    </p>
    <p>The <dfn id="messagelabel-parentid" title="MessageLabel-parentId"> <code>parentId</code> </dfn>
    property is the identifier of the parent label.
    </p>
    <p>The <dfn id="messagelabel-messagetype" title="MessageLabel-messageType"> <code>messageType</code> </dfn>
    property is the identifier of the message type for which the label is defined.
    If the value is <code>null</code>, the label is valid for all message types.
    </p>
    <p>The <dfn id="messagelabel-serviceid" title="MessageLabel-serviceId"> <code>serviceId</code> </dfn>
    property is the identifier of the messaging service on which the label is
    defined. If the value is <code>null</code>, the label is valid on all
    messaging services.
    </p>
  </div> <!-- interface MessageLabel -->


  <div> <!-- interface MessageFolder -->
    <h3 id="interface-messagefolder"><span class="secno">5.20 </span>Interface <code title="">MessageFolder</code></h3>
    <p>Defines message folders.</p>
    <pre class="idl">    [NoInterfaceObject]
    interface <dfn id="messagefolder">MessageFolder</dfn> : <a href="#messagelabel">MessageLabel</a> {
        readonly attribute DOMString? <a href="#messagefolder-path" title="MessageFolder-path">path</a>;
        readonly attribute DOMString <a href="#messagefolder-type" title="MessageFolder-type">type</a>;
        attribute boolean <a href="#messagefolder-synchronizable" title="MessageFolder-synchronizable">synchronizable</a>;
        attribute boolean <a href="#messagefolder-exportlocalupdates" title="MessageFolder-exportLocalUpdates">exportLocalUpdates</a>;
    };
    </pre>
    <p>The <dfn id="messagefolder-path" title="MessageFolder-path"> <code>path</code> </dfn> property
    MUST return the path of the remote folder on the server. If the messaging
    service does not support remote folders on the server, this property MUST
    return <code>null</code>.
    </p>
    <p>The <dfn id="messagefolder-type" title="MessageFolder-type"> <code>type</code> </dfn> property
    MUST return the folder type. The value MUST take one of the following: <ul>
    <li><code>"inbox"</code>, for incoming messages</li>
    <li><code>"outbox"</code>, for messages which are being sent</li>
    <li><code>"send"</code>, for sent messages</li>
    <li><code>"drafts"</code>, for draft messages</li>
    <li><code>"generic"</code>, for any other folder.</ul>
    Implementations MUST support "inbox" type folders.
    Filtering MUST be supported for this property.
    <p></p>
    <p>The <dfn id="messagefolder-synchronizable" title="MessageFolder-synchronizable"><code>synchronizable</code></dfn>
    flag tells whether the folder SHOULD be synchronized, which affects the
    behavior of the
    <a href="#emailservice-syncfolder" title="EmailService-syncFolder"><code>EmailService.syncFolder()</code></a> and
    <a href="#emailservice-sync" title="EmailService-sync"><code>EmailService.sync()</code></a> methods.
    </p>
    <p>The <dfn id="messagefolder-exportlocalupdates" title="MessageFolder-exportLocalUpdates">
           <code>exportLocalUpdates</code> </dfn> flag tells whether the changes
    done to this folder SHOULD be synchronized with the remote folder on the server.
    It affects the behavior of the
    <a href="#emailservice-syncfolder" title="EmailService-syncFolder"><code>EmailService.syncFolder()</code></a> and
    <a href="#emailservice-sync" title="EmailService-sync"><code>EmailService.sync()</code></a> methods.
    </p>
  </div> <!-- interface MessageFolder -->


  <div> <!-- interface MessageConversation -->
    <h3 id="interface-messageconversation"><span class="secno">5.21 </span>Interface <code title="">MessageConversation</code></h3>
    <pre class="idl">    [NoInterfaceObject]
    interface <dfn id="messageconversation">MessageConversation</dfn> {
        readonly attribute DOMString <a href="#messageconversation-id" title="MessageConversation-id">id</a>;
        readonly attribute DOMString <a href="#messageconversation-type" title="MessageConversation-type">type</a>;
        readonly attribute Date <a href="#messageconversation-timestamp" title="MessageConversation-timestamp">timestamp</a>;
        readonly attribute unsigned long <a href="#messageconversation-messagecount" title="MessageConversation-messageCount">messageCount</a>;
        readonly attribute unsigned long <a href="#messageconversation-unreadmessages" title="MessageConversation-unreadMessages">unreadMessages</a>;
        readonly attribute DOMString <a href="#messageconversation-subject" title="MessageConversation-subject">subject</a>;
        readonly attribute DOMString[] <a href="#messageconversation-participants" title="MessageConversation-participants">participants</a>;
        readonly attribute MessageId <a href="#messageconversation-lastmessageid" title="MessageConversation-lastMessageId">lastMessageId</a>;
        readonly attribute boolean <a href="#messageconversation-isread" title="MessageConversation-isRead">isRead</a>;
        readonly attribute <a href="#message">Message[]</a> <a href="#messageconversation-messages" title="MessageConversation-messages">messages</a>;
    };
    </pre>
    <p>Defines a message conversation, also known as a message thread.
    </p>
    <p>The <dfn id="messageconversation-id" title="MessageConversation-id"> <code>id</code> </dfn> property
    MUST return the unique identifier of the conversation unique identifier, which
    MUST be locally unique and persistent, assigned by the device or the web runtime.
    Filtering MUST be supported for this property.
    </p>
    <p>The <dfn id="messageconversation-type" title="MessageConversation-type"> <code>type</code> </dfn> property
    MUST return the message type in the given conversation.
    Filtering MUST be supported for this property.
    </p>
    <p>The <dfn id="messageconversation-timestamp" title="MessageConversation-timestamp"> <code>timestamp</code> </dfn>
    property MUST return the timestamp of the latest message in the conversation.
    This property is set up by the device or the web runtime environment.
    Filtering MUST be supported for this property.
    </p>
    <p>The <dfn id="messageconversation-messagecount" title="MessageConversation-messageCount"> <code>messageCount</code> </dfn>
    property MUST return the number of messages in the conversation.
    Filtering MAY be supported for this property.
    </p>
    <p>The <dfn id="messageconversation-unreadmessages" title="MessageConversation-unreadMessages">
           <code>unreadMessages</code> </dfn> property MUST return the number of
    unread messages in the conversation.
    </p>
    <p>The <dfn id="messageconversation-subject" title="MessageConversation-subject"> <code>subject</code> </dfn>
    property MUST return the subject of the message conversation.
    Filtering MUST be supported for this property.
    </p>
    <p>The <dfn id="messageconversation-participants" title="MessageConversation-participants"> <code>participants</code> </dfn>
    property returns the list of participant addresses in the conversation in the
    form of an array of strings.
    Filtering MUST be supported for this property.
    </p>
    <p>The <dfn id="messageconversation-lastmessageid" title="MessageConversation-lastMessageId"> <code>lastMessageId</code> </dfn>
    preoperty MUST return the identifier of the last message in the conversation.
    </p>
    <p>The <dfn id="messageconversation-isread" title="MessageConversation-isRead"> <code>isRead</code> </dfn>
    flag tells if there are unread messages in the conversation.
    Filtering MUST be supported for this property.
    </p>
    <p>The <dfn id="messageconversation-messages" title="MessageConversation-messages"> <code>messages</code> </dfn>
    property MUST return the list of messages in the conversation as an array of
    <a href="#message"><code>Message</code></a> objects.
    </p>
  </div> <!-- interface MessageConversation -->


  <div>
    <h2 id="data-models"><span class="secno">6 </span>Data Models</h2>
  </div>


  <div> <!-- interface LiveSearch -->
    <h3 id="interface-livesearch"><span class="secno">6.1 </span>Interface <code title="">LiveSearch</code></h3>
    <p>Provides functionality for (optionally filtered) retrieval of data items
    from an implementation-defined storage, and maintaining the result set
    updated with later changes.
    The interface provides a possibility for notifying updates by events.
    This interface can be used instead of e.g. simple arrays of objects when
    with the given data usage pattern performance would be affected,
    For instance in the case of frequently changing data.
    </p>
    <pre class="idl">    interface <dfn id="livesearch">LiveSearch</dfn> : <span>EventTarget</span> {
        attribute EventHandler <a href="#livesearch-onadded" title="LiveSearch-onadded">onadded</a>;
        attribute EventHandler <a href="#livesearch-onmodified" title="LiveSearch-onmodified">onmodified</a>;
        attribute EventHandler <a href="#livesearch-onremoved" title="LiveSearch-onremoved">onremoved</a>;
        <span>ItemUpdates</span> <a href="#livesearch-find" title="LiveSearch-find">find</a> (optional <a href="#abstractfilter">AbstractFilter</a>? <var>filter</var>, optional <a href="#filteroptions">FilterOptions</a><var><a href="#filteroptions">filterOptions</a></var>);
    };
    </pre>
    <p>The <dfn id="livesearch-onadded" title="LiveSearch-onadded"> <code>onadded</code></dfn>
    property is an event handler for the <code>added</code> event fired when new
    data items have been added to the underlying data storage which also satisfy
    the filter set by the <code>find()</code> method.
    </p>
    <p>The <dfn id="livesearch-onmodified" title="LiveSearch-onmodified"> <code>onmodified</code></dfn>
    property is an event handler for the <code>modified</code> event fired when
    existing data items have been modified in the underlying data storage which
    also satisfy the filter set by the <code>find()</code> method.
    </p>
    <p>The <dfn id="livesearch-onremoved" title="LiveSearch-onremoved"> <code>onremoved</code></dfn>
    property is an event handler for the <code>removed</code> fired when
    existing data items have been removed from the underlying data storage which
    also satisfied the filter set by the <code>find()</code> method.
    </p>
    <p>The <dfn id="livesearch-find" title="LiveSearch-find"><code>find</code></dfn> property is
    a method for searching for data items satisfying the specified filters, or
    if no filters specified, then the full available data set.
    The parameter <code><var>filter</var></code> is a filter for selecting the
    subset of data items to be searched for.
    The parameter <a href="#filteroptions"><code><var>filterOptions</var></code></a> is the
    filter settings for controlling result set ordering and retrieval.
    The method MUST synchronously return a <a href="#pendingrequest"><code>PendingRequest</code></a>
    object for retrieving the result set asynchronously.
    If filters are used with this method, the subsequent updates MUST be relative
    to the result set, i.e. the updates MUST be also filtered by the same filter.
    A next call of this method MUST reset the result set according to the
    parameters used with the method call.
    </p>
  </div> <!-- interface LiveSearch -->


  <div> <!-- interface LiveModel -->
    <h3 id="interface-livemodel"><span class="secno">6.2 </span>Interface <code title="">LiveModel</code></h3>
    <p>Provides functionality for adding, modifying and deleting data items to a
    storage defined by the implementation. Also, implements the
    <a href="#livesearch"><code>LiveSearch</code></a> interface which provides filtered
    search of data items and maintains the result set updated with later changes.
    This interface can be used for creating live data models synchronized
    with data changes done to the data backend, by first doing a filtered search
    and then listening to updates and writing changes to the storage.
    </p>
    <pre class="idl">    [NoInterfaceObject]
    interface <dfn id="livemodel">LiveModel</dfn> : <a href="#livesearch">LiveSearch</a> {
        <a href="#pendingrequest">PendingRequest</a> <a href="#livemodel-add" title="LiveModel-add">add</a>(Object[] <var>addedItems</var>);
        <a href="#pendingrequest">PendingRequest</a> <a href="#livemodel-modify" title="LiveModel-modify">modify</a>(Object[] <var>modifiedItems</var>);
        <a href="#pendingrequest">PendingRequest</a> <a href="#livemodel-remove" title="LiveModel-remove">remove</a>(DOMString[] <var>removedIds</var>);
        <a href="#pendingrequest">PendingRequest</a> <a href="#livemodel-removeall" title="LiveModel-removeAll">removeAll</a>();
    };
    </pre>
    <p>The <dfn id="livemodel-add" title="LiveModel-add"><code>add</code></dfn> property is a
    method for adding data items to the storage.
    The parameter <code><var>addedItems</var></code> is an array containing the
    objects to be added to the storage. After the items are added, they will
    likely be changed by the storage, for instance will get an identifier generated.
    All the changes are notified to the applications using the events defined in
    the <a href="#livesearch"><code>LiveSearch</code></a> interface.
    The method returns a <a href="#pendingrequest"><code>PendingRequest</code></a> object for
    controlling the asynchronous operation and for accessing the result.
    After the operation completes, the
    <a href="#pendingrequest-result" title="PendingRequest-result"><code>result</code></a> property
    MUST contain the number of items added, of type <code>unsigned long</code>.
    </p>
    <p>The <dfn id="livemodel-modify" title="LiveModel-modify"><code>modify</code></dfn> property is a
    method for modifying existing data items in the storage.
    The parameter <code><var>modifiedItems</var></code> is an array containing the
    objects to be modified in the storage.
    All the changes MUST be notified to the applications using the events defined
    in the <a href="#livesearch"><code>LiveSearch</code></a> interface, except the one pushing
    the change.
    The method returns a <a href="#pendingrequest"><code>PendingRequest</code></a> object for
    controlling the asynchronous operation and for accessing the result.
    After the operation completes, the
    <a href="#pendingrequest-result" title="PendingRequest-result"><code>result</code></a> property
    MUST contain the number of items modified, of type <code>unsigned long</code>.
    </p>
    <p>The <dfn id="livemodel-remove" title="LiveModel-remove"> <code>remove</code> </dfn> property is
    a method for removing existing data items from the storage.
    The parameter <code><var>removedIds</var></code> is an array containing the
    identifiers of the objects to be removed the storage. The identifiers MUST be
    unique keys in the storage.
    All the changes MUST be notified to the applications using the events defined
    in the <a href="#livesearch"><code>LiveSearch</code></a> interface, except the one pushing
    the change.
    The method returns a <a href="#pendingrequest"><code>PendingRequest</code></a> object for
    controlling the asynchronous operation and for accessing the result.
    After the operation completes, the
    <a href="#pendingrequest-result" title="PendingRequest-result"><code>result</code></a> property
    MUST contain the number of items removed, of type <code>unsigned long</code>.
    </p>
    <p>The <dfn id="livemodel-removeall" title="LiveModel-removeAll"> <code>removeAll</code> </dfn> is
    a method for removing all items in the storage.
    The method MUST return an <a href="#pendingrequest"><code>PendingRequest</code></a> object for
    handling the completion of the asynchronous operation.
    After the operation completes, the
    <a href="#pendingrequest-result" title="PendingRequest-result"><code>result</code></a> property
    MUST contain the number of items removed, of type <code>unsigned long</code>.
    If the remove operation is not supported, the error code MUST be set to
    <code>NotSupportedError</code> and an <code>error</code> event MUST be fired
    to the <a href="#pendingrequest"><code>PendingRequest</code></a> object.
    </p>
  </div> <!-- interface LiveModel -->


  <div>
    <h2 id="asynchronous-operations"><span class="secno">7 </span>Asynchronous operations</h2>
  </div>


  <div> <!-- interface PendingRequest -->
    <h3 id="interface-pendingrequest"><span class="secno">7.1 </span>Interface <code title="">PendingRequest</code></h3>
    <p>Defines the object handling asynchronous operations and providing iterator
    functionality over the result set when the size of the result set is larger
    than the limit set by the client.
    </p>
    <pre class="idl">    [NoInterfaceObject]
    interface <dfn id="pendingrequest">PendingRequest</dfn> : EventTarget {
        readonly attribute DOMString <a href="#pendingrequest-state" title="PendingRequest-state">state</a>;
        readonly attribute any <a href="#pendingrequest-args" title="PendingRequest-args">args</a>;
        readonly attribute any <a href="#pendingrequest-timeout" title="PendingRequest-timeout">timeout</a>;
        attribute unsigned long <a href="#pendingrequest-resultslimit" title="PendingRequest-resultsLimit">resultLimit</a>;
        readonly attribute any <a href="#pendingrequest-result" title="PendingRequest-result">result</a>;
        readonly attribute DOMError <a href="#pendingrequest-error" title="PendingRequest-error">error</a>;
        attribute EventHandler <a href="#pendingrequest-onerror" title="PendingRequest-onerror">onerror</a>;
        attribute EventHandler <a href="#pendingrequest-onsuccess" title="PendingRequest-onsuccess">onsuccess</a>;
        void <a href="#pendingrequest-cancel" title="PendingRequest-cancel">cancel()</a>;
    };
    </pre>
    <p>The <dfn id="pendingrequest-state" title="PendingRequest-state"> <code>state</code> </dfn>
    property MUST provide the state of the asynchronous request with one of the
    following values:<ul>
    <li><code>"none"</code>, meaning inactive state not bound with any
    asynchronous requests yet. This is the default state after object creation.</li>
    <li><code>"pending"</code>, meaning a pending asynchronous request is bound
    and the object is waiting for the completion of the asynchronous operation.</li>
    <li><code>"aborted"</code>, meaning the operation was succesfully aborted by
    the <code>cancel</code> method. It can be set if the previous state was
    <code>"pending"</code> or <code>"iterating"</code>.</li>
    <li><code>"timeout"</code>, meaning the operation was aborted because a
    timeout occured. It can be set only when the previous state was
    <code>"pending"</code>.</li>
    <li><code>"done"</code>, meaning the asynchronous request has completed and
    all eventual results have been returned and are available.
    <li><code>"iterating"</code>, meaning the asynchronous operation has completed,
    the reply to the asynchronous request has provided in a larger result set
    than the limit set in the <code>resultsLimit</code> property, and a chunk of
    the results is now available. When the last result set chunk is provided, the
    <code>state</code> value MUST be set to <code>"done"</code>.</li>
    </ul>
    The succession of states in the case of a single result is:
    <code>"none"</code>, <code>"pending"</code>, [<code>"aborted"</code> or
    <code>"timeout"</code>], <code>"done"</code>.
    The succession of states in the case of a result which is an array of objects
    larger than the limit set:
    <code>"none"</code>, <code>"pending"</code>, [<code>"aborted"</code> or
    <code>"timeout"</code>], <code>"iterating"</code>, [<code>"aborted"</code>],
    <code>"done"</code>.
    The <code>"iterating"</code> state can repeat any number of times.
    <p></p>
    <p> The <dfn id="pendingrequest-timeout" title="PendingRequest-timeout"><code>timeout</code></dfn>
    property can be set to the desired timeout expressed in milliseconds.
    The default value is <code>0</code>, meaning no timeout is set.
    If the asynchronous operation takes longer than the specified timeout, then
    the operation MUST be signaled to be cancelled. After the operation is
    successfully canceled, an <code>error</code> event MUST be fired
    with the <code>error</code> property set to <code>TimeoutError</code>, and the
    <code>state</code> property MUST be set to <code>"timeout"</code>.
    </p>
    <p>The <dfn id="pendingrequest-args" title="PendingRequest-args"> <code>args</code> </dfn> property
    MUST return an array of objects representing the arguments of the asynchronous
    request.
    </p>
    <p>The <dfn id="pendingrequest-resultslimit" title="PendingRequest-resultsLimit"><code>resultsLimit</code></dfn>
    property represents the limit set to the number of results returned in one
    iteration. The default value is <code>0</code>, meaning no limit.
    </p>
    <p>The <dfn id="pendingrequest-result" title="PendingRequest-result"> <code>result</code> </dfn>
    property MUST provide the result of the asynchronous operation when the
    status is <code>"done"</code>. The type of the result depends on the operation,
    such as <code>null</code>, a single value, an object or an array of values or
    objects.
    When the state is not <code>"done"</code> or <code>"iterating"</code>, then
    getting this property MUST throw a <span><code>DOMException</code></span>
    of type <span><code>INVALID_STATE_ERR</code><span>.
    Setting this property means the results have been read by the client.
    When this property is set (typically to <code>null</code>) while the state is
    <code>"iterating"</code>, it means the implementation can provide the next
    chunk of the result set, notified by sending a <code>success</code> event to
    the object. When the state is <code>"done"</code> and this property is set,
    then the object becomes idle and can be collected.
    </span></span></p>
    <p>The <dfn id="pendingrequest-error" title="PendingRequest-error"> <code>error</code> </dfn> property
    MUST provide the error information, if available.
    </p>
    <p>The <dfn id="pendingrequest-onerror" title="PendingRequest-onerror"> <code>onerror</code> </dfn>
    property MUST provide a function which is called when the asynchronous
    operation completes with an error and a <span>DOMError</span> event is raised.
    <p>The <dfn id="pendingrequest-onsuccess" title="PendingRequest-onsuccess"> <code>onsuccess</code> </dfn>
    property MUST provide a function which is called when the asynchronous
    operation completes successfully and the status is <code>"done"</code> or
    <code>"iterating"</code>.
    </p>
    <p> The <dfn id="pendingrequest-cancel" title="PendingRequest-cancel"><code>cancel</code></dfn>
    property is a method for cancelling the asynchrounous operation and MUST only
    be called if the <code>state</code> is <code>"pending"</code> or
    <code>"iterating"</code>. In other states, the implementation MUST throw a
    <span><code>DOMException</code></span> of type
    <span><code>INVALID_STATE_ERR</code><span>.
    After the operation is successfully canceled, an <code>error</code> event MUST
    be fired with the <code>error</code> property set to <code>AbortError</code>,
    and the <code>state</code> property MUST be set to <code>"aborted"</code>.
    </span></span></p>
  </div> <!-- interface PendingRequest -->


  <div> <!-- interface SendRequest -->
    <h3 id="interface-sendrequest"><span class="secno">7.2 </span>Interface <code title="">SendRequest</code></h3>
    <p>Defines the object handling asynchronous operations for sending messages.
    </p>
    <pre class="idl">    [NoInterfaceObject]
    interface <dfn id="sendrequest">SendRequest</dfn> : <a href="#pendingrequest">PendingRequest</a> {
        attribute EventHandler <a href="#sendrequest-ondelivered" title="SendRequest-ondelivered">ondelivered</a>;
    };
    </pre>
    <p>The <dfn id="sendrequest-ondelivered" title="SendRequest-ondelivered"> <code>ondelivered</code> </dfn>
    is the event handler for the <code>delivered</code> event fired when the
    service reports a delivered message.
    </p>
  </div> <!-- interface SendRequest -->


  <div>
    <h2 id="data-filtering"><span class="secno">8 </span>Data filtering</h2>
    <p>This generic filtering API provides searching functionality for messages,
    folders, labels and conversations.
  </div>


  <div> <!-- interface AbstractFilter -->
    <h3 id="interface-abstractfilter"><span class="secno">8.1 </span>Interface <code title="">AbstractFilter</code></h3>
    <p>Defines the abstract filter interface inherited by all filter types.
    </p>
    <pre class="idl">[NoInterfaceObject]
    [NoInterfaceObject]
    interface <dfn id="abstractfilter">AbstractFilter</dfn> {
    };
    </pre>
  </div>

  <div> <!-- interface AttributeFilter -->
    <h3 id="interface-attributefilter"><span class="secno">8.2 </span>Interface <code title="">AttributeFilter</code></h3>
    <p>Defines a filter for matching items on a condition on one of the supported
    objects attributes.
    </p>
    <pre class="idl">enum <dfn id="attributefilteroperator">AttributeFilterOperator</dfn> { "is", "contains", "startswith", "endswith", "exists" };

    Constructor(DOMString <var title="">filterBy</var>, DOMString <var title="">attributeOp</var>, optional any filterValue)]
    interface <dfn id="attributefilter">AttributeFilter</dfn> : <a href="#abstractfilter">AbstractFilter</a> {
        attribute DOMString <a href="#attributefilter-filterby" title="AttributeFilter-filterBy">filterBy</a>;
        attribute <a href="#attributefilteroperator">AttributeFilterOperator</a> <a href="#attributefilter-operator" title="AttributeFilter-operator">operator</a>;
        attribute any <a href="#attributefilter-filtervalue" title="AttributeFilter-filterValue">filterValue</a>;
    };
    </pre>
    <p>The <dfn id="attributefilter-filterby" title="AttributeFilter-filterBy"><code>filterBy</code></dfn>
    property indicates which attribute the filter SHOULD be applied.
    The implementation MUST match the string to the attributes of the object
    which owns the filter object.
    </p>
    <p>The <dfn id="attributefilter-operator" title="AttributeFilter-operator"><code>operator</code></dfn>
    property represents the operator used for matching. Possible values are
    <code>"is"</code>, <code>"contains"</code>, <code>"startsWith"</code>,
    <code>"endsWith"</code>, <code>"exists"</code>. The following operators only
    apply to attributes of DOMString type: <code>"contains"</code>,
    <code>"startsWith"</code>, <code>"endsWith"</code>.
    </p>
    <p>The <dfn id="attributefilter-filtervalue" title="AttributeFilter-filterValue"><code>filterValue</code></dfn>
    property is the value used for matching. This value SHOULD be <code>null</code>
    if the <a href="#attributefilter-operator" title="AttributeFilter-operator"><code>operator</code></a>
    is set to <code>"exists"</code>.
    </p>
  </div> <!-- interface AttributeFilter -->

  <div> <!-- interface AttributeRangeFilter -->
  <h3 id="interface-attributerangefilter"><span class="secno">8.3 </span>Interface <code title="">AttributeRangeFilter</code></h3>
  <p>Defines filters representing conditions matching a range of property values.
  <pre class="idl">  Constructor(DOMString <var title="">attributeName</var>, optional any <var title="">startValue</var>, optional any <var title="">endValue</var>)]
  interface <dfn id="attributerangefilter">AttributeRangeFilter</dfn> : <a href="#abstractfilter">AbstractFilter</a> {
      attribute DOMString <a href="#attributerangefilter-filterby" title="AttributeRangeFilter-filterBy">filterBy</a>;
      attribute any <a href="#attributerangefilter-startvalue" title="AttributeRangeFilter-startValue">startValue</a>;
      attribute any <a href="#attributerangefilter-endvalue" title="AttributeRangeFilter-endValue">endValue</a>;
  };
  </pre>
  <p>The <dfn id="attributerangefilter-filterby" title="AttributeRangeFilter-filterBy"><code>filterBy</code></dfn>
  attribute indicates which object attribute we should filter on, specified as
  <code>DOMString</code> (e.g.<code>"from"</code>, <code>"name"</code>).
  </p>
  <p>The <dfn id="attributerangefilter-startvalue" title="AttributeRangeFilter-startValue"><code>startValue</code></dfn>
  attribute should indicate the lower bound of the matching interval. This
  attribute may be <code>null</code> for open ended intervals.
  </p>
  <p>The <dfn id="attributerangefilter-endvalue" title="AttributeRangeFilter-endValue"><code>endValue</code></dfn>
  attribute should indicate the upper bound of the matching interval. This
  attribute may be <code>null</code> for open ended intervals.
  </p>
</div> <!-- interface AttributeRangeFilter -->


  <div> <!-- interface CompositeFilter -->
    <h3 id="interface-compositefilter"><span class="secno">8.4 </span>Interface <code title="">CompositeFilter</code></h3>
    <p>Defines a filter composed of several other filters to represent complex
    search conditions.
    </p>
    <pre class="idl">    enum <dfn id="compositefilteroperator">CompositeFilterOperator</dfn> { "and", "or" };

    Constructor(DOMString <var title="">operator</var>, <a href="#abstractfilter">AbstractFilter</a>[] <var title="">filters</var>)]
    interface <dfn id="compositefilter">CompositeFilter</dfn> : <a href="#abstractfilter">AbstractFilter</a> {
        attribute <a href="#compositefilteroperator">CompositeFilterOperator</a> <a href="#compositefilter-operator" title="CompositeFilter-operator">operator</a>;
        attribute <a href="#abstractfilter">AbstractFilter</a>[] <a href="#compositefilter-filters" title="CompositeFilter-filters">filters</a>;
      };
    </pre>
    <p>The <dfn id="compositefilter-operator" title="CompositeFilter-operator"><code>operator</code></dfn>
    property indicates how the filters SHOULD be joined together.
    The <code>"and"</code> operator returns a record if it matched by <b>all</b>
    filters. The <code>"or"</code> operator returns an item if it matched by
    one of the filters.
    </p>
    <p>The <dfn id="compositefilter-filters" title="CompositeFilter-filters"><code>filters</code></dfn>
    property is an array of filters that are part of this
    <a href="#compositefilter"><code>CompositeFilter</code></a>.
    </p>
  </div> <!-- interface CompositeFilter -->


  <div> <!-- dictionary FilterOptions -->
    <h3 id="dictionary-filteroptions"><span class="secno">8.5 </span>Dictionary <code title="">FilterOptions</code></h3>
    <p>Defines a dictionary to customize sorting and retrieval of the result set.
    </p>
    <pre class="idl">enum <dfn id="sortorder">SortOrder</dfn> { "ascending", "descending" };

    dictionary <dfn id="filteroptions">FilterOptions</dfn> {
        DOMString <a href="#filteroptions-sortby" title="FilterOptions-sortBy">sortBy</a>;
        <a href="#sortorder">SortOrder</a> <a href="#filteroptions-sortorder" title="FilterOptions-sortOrder">sortOrder</a> = "ascending";
        unsigned long <a href="#filteroptions-limit" title="FilterOptions-limit">limit</a>;
        unsigned long <a href="#filteroptions-offset" title="FilterOptions-offset">offset</a>;
    };
    </pre>
    <p>The <dfn id="filteroptions-sortby" title="FilterOptions-sortBy"><code>filterBy</code></dfn> key
    indicates which attribute SHOULD be used for sorting the filtering results.
    </p>
    <p>The <dfn id="filteroptions-sortorder" title="FilterOptions-sortOrder"><code>sortOrder</code></dfn> key
    indicates the order in which the filtering results SHOULD be sorted. Possible
    values are <code>"ascending"</code> (default) and <code>"descending"</code>.
    </p>
    <p>The <dfn id="filteroptions-limit" title="FilterOptions-limit"><code>limit</code></dfn> key
    indicates the maximum number of filtering results that SHOULD be returned.
    </p>
    <p>The <dfn id="filteroptions-offset" title="FilterOptions-offset"><code>offset</code></dfn> key
    indicates the offset  in the full result set where the current subset of
    filtering results belong.
    </p>
  </div>

  <div> <!-- interface MessageFilter -->
    <h3 id="interface-messagefilter"><span class="secno">8.6 </span>Interface <code title="">MessageFilter</code></h3>
    <p>Defines a special filter for message search, which can be used in
    <a href="#compositefilter"><code>CompositeFilter</code></a> objects.
    Generic <a href="#attributefilter"><code>AttributeFilter</code></a> and
    <a href="#attributerangefilter"><code>AttributeRangeFilter</code></a> filters MAY also be used for
    message search. This filter just explicitly defines and collects the
    properties on which conditions may be formulated.
    </p>
    <pre class="idl">    dictionary <dfn id="messagefilterdict">MessageFilterDict</dfn> {
        Date <a href="#messagefilter-startdate" title="MessageFilter-startDate">startDate</a>;
        Date <a href="#messagefilter-enddate" title="MessageFilter-endDate">endDate</a>;
        DOMString[] <a href="#messagefilter-destinations" title="MessageFilter-destinations">destinations</a>;
        DOMString[] <a href="#messagefilter-from" title="MessageFilter-from">from</a>;
        DOMString <a href="#messagefilter-status" title="MessageFilter-status">status</a>;
        DOMString <a href="#messagefilter-conversation" title="MessageFilter-conversation">conversation</a>;
        DOMString <a href="#messagefilter-folder" title="MessageFilter-folder">folder</a>;
        DOMString[] <a href="#messagefilter-labels" title="MessageFilter-labels">labels</a>;
        boolean <a href="#messagefilter-read" title="MessageFilter-read">read</a>;
        boolean <a href="#messagefilter-hasattachments" title="MessageFilter-hasAttachments">hasAttachments</a>;
    };

    [Constructor(MessageFilterDict initDict)]
    interface <dfn id="messagefilter">MessageFilter</dfn> : <a href="#abstractfilter">AbstractFilter</a> {
        // properties defined in MessageFilterDict
    };
    </pre>
    <p>The <dfn id="messagefilter-startdate" title="MessageFilter-startDate"><code>startDate</code></dfn>
    property specifies either the message
    <a href="#message-timestamp" title="Message-timestamp"> <code>timestamp</code></a>,
    or the start date of the interval in which the timestamp should be.
    If the <code>endDate</code> property is specified, the <code>startDate</code>
    property means the beginning of the time interval, otherwise it serves for
    exact matching of the message time stamp.
    </p>acts and
    <p>The <dfn id="messagefilter-enddate" title="MessageFilter-endDate"><code>endDate</code></dfn>
    property specifies the end date of the interval in which the message
    <a href="#message-timestamp" title="Message-timestamp"> <code>timestamp</code></a> should be.
    </p>
    <p>The <dfn id="messagefilter-destinations" title="MessageFilter-destinations"><code>destinations</code></dfn>
    property is an array containing the destinations of the message (including
    the <code>to</code>, <code>cc</code> and <code>bcc</code> properties, any
    of which the message should match (i.e. has OR semantics).
    </p>
    <p>The <dfn id="messagefilter-from" title="MessageFilter-from"><code>from</code></dfn>
    property is an array containing the sources of the message, any of which the
    message should match (i.e. has OR semantics).
    </p>
    <p>The <dfn id="messagefilter-status" title="MessageFilter-status"><code>status</code></dfn>
    property matches against the message <code>status</code> property with an
    exact matching.
    </p>
    <p>The <dfn id="messagefilter-conversation" title="MessageFilter-conversation"><code>conversation</code></dfn>
    property matches against the message <code>conversationId</code> property
    with an exact matching.
    </p>
    <p>The <dfn id="messagefilter-folder" title="MessageFilter-folder"><code>folder</code></dfn>
    property against the message <code>folderId</code> property with an
    exact matching.
    </p>
    <p>The <dfn id="messagefilter-labels" title="MessageFilter-labels"><code>labels</code></dfn>
    property is an array containing the <code>labels</code> property of the
    message, any of which the message should match (i.e. has OR semantics).
    </p>
    <p>The <dfn id="messagefilter-read" title="MessageFilter-read"><code>read</code></dfn>
    property is matched against the message <code>isRead</code> property.
    </p>
    <p>The <dfn id="messagefilter-hasattachments" title="MessageFilter-hasAttachments"><code>hasAttachments</code></dfn>
    property matches messages which do (for value <code>true</code>), or do not
    have attachments (for value <code>false</code>).
    </p>
  </div> <!-- interface MessageFilter -->

</div> <!-- "mainspec" -->


<div id="references">
     <h2 class="no-num" id="references-0">References</h2>
     <div id="anolis-references"> <dl><dt id="refsHTML5">[HTML5]
<dd><cite><a href="http://dev.w3.org/html5/spec/">HTML5</a></cite>, Ian Hickson. W3C.

<dt id="refsWEBIDL">[WEBIDL]
<dd><cite><a href="http://dev.w3.org/2006/webapi/WebIDL/">Web IDL</a></cite>, Cameron McCormack. W3C.

</dl></div>
</div>

<div id="acknowledgements">
     <h2 class="no-num" id="acknowledgments">Acknowledgements</h2>
     <p>This specification is based partly on the <a href="https://developer.tizen.org/help/index.jsp?topic=%2Forg.tizen.web.device.apireference%2Ftizen%2Fmessaging.html">Tizen Web Messaging API</a> specification.
     Thanks to Mikhail Pozdnyakov and Alexander Shalamov (Intel), as well as to
     Samsung for that work.
     </p>
     <p>Thanks to Cristophe Dumez (Intel) for designing the generic search
     filters used in the <a href="#data-filtering">Data filtering</a> section.
     </p>
     <p>Thanks to Jonas Sicking, Mounir Lamouri (Mozilla), and Eduardo Fullea
     (Telefonica) for the useful discussions.
</div>



